import{s as ut,n as Ve,d,O as ot,A as tt,P as Y,b as Z,x as u,i as H,e as o,Q as F,f as h,h as C,R as J,k as I,j as A,l as v,m as S,t as U,p as at,r as mt,z as vt,S as Ye,T as Lt,U as et,V as jt,y as Ue,W as dl,X as ml,Y as zt,Z as es,I as pl,_ as gl,$ as _l}from"../chunks/scheduler.lp2dcU7o.js";import{S as ft,i as dt,f as At,d as st,t as Xe,a as Fe,m as lt,e as nt,b as rt,g as Ut,c as Ht}from"../chunks/index.D_SAiAUa.js";function Je(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}class Et{constructor(){this.storageKey="diary_entries",this.metadataKey="diary_metadata"}getAllEntries(){if(typeof window>"u")return{};try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading diary entries:",e),{}}}getEntry(e,t=null){const s=t||this.storageKey;if(typeof window>"u")return"";try{const n=localStorage.getItem(s);return(n?JSON.parse(n):{})[e]||""}catch(n){return console.error("Error reading diary entry:",n),""}}saveEntry(e,t,s=null){if(typeof window>"u")return;const n=s||this.storageKey;try{const r=localStorage.getItem(n),a=r?JSON.parse(r):{};a[e]=t,localStorage.setItem(n,JSON.stringify(a))}catch(r){console.error("Error saving diary entry:",r)}}deleteEntry(e,t=null){if(typeof window>"u")return;const s=t||this.storageKey;try{const n=localStorage.getItem(s),r=n?JSON.parse(n):{};delete r[e],localStorage.setItem(s,JSON.stringify(r))}catch(n){console.error("Error deleting diary entry:",n)}}getRecentEntries(e=5){const t=this.getAllEntries();return Object.keys(t).filter(n=>t[n]&&t[n].trim().length>0).sort((n,r)=>new Date(r+"T00:00:00")-new Date(n+"T00:00:00")).slice(0,e).map(n=>({date:n,content:t[n]}))}getContextForAgents(e=5){const t=this.getRecentEntries(e);if(t.length===0)return"";const s=t.filter(r=>!this.getMetadata(r.date).isPrivate);return s.length===0?"":`Previous diary entries for context:

${s.map(r=>`Date: ${r.date}
${r.content}`).join(`

---

`)}`}formatDate(e=new Date){const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${n}`}getAllMetadata(){if(typeof window>"u")return{};try{const e=localStorage.getItem(this.metadataKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading diary metadata:",e),{}}}getMetadata(e){return this.getAllMetadata()[e]||{starred:!1,tags:[],mood:null,wordCount:0,isPrivate:!1}}saveMetadata(e,t){if(!(typeof window>"u"))try{const s=this.getAllMetadata();s[e]={...this.getMetadata(e),...t},localStorage.setItem(this.metadataKey,JSON.stringify(s))}catch(s){console.error("Error saving diary metadata:",s)}}toggleStar(e){const t=this.getMetadata(e);return this.saveMetadata(e,{starred:!t.starred}),!t.starred}getStarredEntries(){const e=this.getAllMetadata();return Object.keys(e).filter(t=>e[t].starred)}addTag(e,t){const s=this.getMetadata(e);s.tags.includes(t)||this.saveMetadata(e,{tags:[...s.tags,t]})}removeTag(e,t){const s=this.getMetadata(e);this.saveMetadata(e,{tags:s.tags.filter(n=>n!==t)})}setMood(e,t){this.saveMetadata(e,{mood:t})}getWordCount(e){return e.trim().split(/\s+/).filter(t=>t.length>0).length}}const Dt={daily:["Right now, I'm feeling...","Today, something that made me smile was...","One thing I'm grateful for today is...","A challenge I'm facing right now is...","Something on my mind that I want to explore is...","How I took care of myself today...","One thing I learned about myself today...","Something I need to let go of from today...","Someone I connected with today made me feel...","I'm looking forward to..."],reflection:["I've noticed a pattern in my feelings lately...","I feel most like myself when...","The situations that make me feel stressed are...","When I'm feeling down, I usually...","If a friend came to me with what I'm going through, I'd tell them...","Home means to me...","The relationships that matter most to me are...","I feel connected to others when...","I feel disconnected when...","Being away from home has changed me by..."],emotional:["The emotions I've been avoiding are...","The last time I cried was...","When I'm anxious, what brings me peace is...","I express joy in my daily life by...","Something that makes me feel proud is...","Feelings of loneliness are triggered by...","I know I'm getting overwhelmed when...","When everything feels chaotic, what grounds me is...","The emotions I wish I could express more openly are...","Since starting college, my emotional landscape has changed because..."],relationships:["The person I miss most right now is...","Something I wish I could tell someone but haven't...","Since being away, my relationships have changed in that...","What I need from the people in my life is...","Someone who makes me feel truly seen is...","A conflict I've been avoiding is...","I maintain connections when I'm far away by...","The support I wish I had right now is...","I show care to others by...","A boundary I need to set is..."],challenges:["The biggest challenge I'm facing right now is...","Something that feels impossible right now is...","A decision I'm struggling with is...","What would help me feel less overwhelmed is...","Something I need permission to do is...","One small step I could take today is...","Support I need but haven't asked for is...","What would make tomorrow easier is...","Something getting in my way is...","If I weren't afraid, I would..."],homesickness:["What I miss most about home is...","A routine from home I wish I could keep is...","I create a sense of home where I am by...","A tradition from home that matters to me is...","A food that reminds me of home is...","I stay connected to my family by...","Something that feels different about my current environment is...","Comfort items or routines that help me feel grounded are...","I balance staying connected with building new roots by...","Parts of home I'm grateful to have brought with me are..."]};function ts(l=null){const e=l?[l]:Object.keys(Dt),t=e[Math.floor(Math.random()*e.length)],s=Dt[t];return s[Math.floor(Math.random()*s.length)]}function ss(l,e,t){const s=l.slice();return s[15]=e[t],s}function ls(l,e,t){const s=l.slice();return s[18]=e[t],s}function ns(l){let e,t=Bt(l[18])+"",s;return{c(){e=v("span"),s=U(t),this.h()},l(n){e=h(n,"SPAN",{class:!0});var r=C(e);s=A(r,t),r.forEach(d),this.h()},h(){u(e,"class","category-label svelte-t9pcmp")},m(n,r){H(n,e,r),o(e,s)},p:Ve,d(n){n&&d(e)}}}function rs(l){let e,t,s=bl(l[18])+"",n,r,a,i,c,f=(l[1]||!l[4])&&ns(l);function m(){return l[11](l[18])}return{c(){e=v("button"),t=v("span"),n=U(s),r=S(),f&&f.c(),a=S(),this.h()},l(b){e=h(b,"BUTTON",{class:!0,title:!0,type:!0});var V=C(e);t=h(V,"SPAN",{class:!0});var M=C(t);n=A(M,s),M.forEach(d),r=I(V),f&&f.l(V),a=I(V),V.forEach(d),this.h()},h(){u(t,"class","category-icon svelte-t9pcmp"),u(e,"class","category-btn-bar svelte-t9pcmp"),u(e,"title",Bt(l[18])),u(e,"type","button"),Y(e,"active",l[0]===l[18]),Y(e,"with-labels",l[1])},m(b,V){H(b,e,V),o(e,t),o(t,n),o(e,r),f&&f.m(e,null),o(e,a),i||(c=F(e,"click",m),i=!0)},p(b,V){l=b,l[1]||!l[4]?f?f.p(l,V):(f=ns(l),f.c(),f.m(e,a)):f&&(f.d(1),f=null),V&1&&Y(e,"active",l[0]===l[18]),V&2&&Y(e,"with-labels",l[1])},d(b){b&&d(e),f&&f.d(),i=!1,c()}}}function as(l){let e,t,s,n=Bt(l[0])+"",r,a,i,c="√ó",f,m,b,V,M,y=l[3]&&os(l),E=Je(Dt[l[0]]),D=[];for(let g=0;g<E.length;g+=1)D[g]=is(ss(l,E,g));return{c(){e=v("div"),t=v("div"),s=v("h3"),r=U(n),a=S(),i=v("button"),i.textContent=c,f=S(),y&&y.c(),m=S(),b=v("div");for(let g=0;g<D.length;g+=1)D[g].c();this.h()},l(g){e=h(g,"DIV",{class:!0});var p=C(e);t=h(p,"DIV",{class:!0});var _=C(t);s=h(_,"H3",{class:!0});var k=C(s);r=A(k,n),k.forEach(d),a=I(_),i=h(_,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-lhub"&&(i.textContent=c),_.forEach(d),f=I(p),y&&y.l(p),m=I(p),b=h(p,"DIV",{class:!0});var w=C(b);for(let N=0;N<D.length;N+=1)D[N].l(w);w.forEach(d),p.forEach(d),this.h()},h(){u(s,"class","svelte-t9pcmp"),u(i,"class","close-prompts svelte-t9pcmp"),u(i,"type","button"),u(t,"class","prompts-header svelte-t9pcmp"),u(b,"class","prompts-list svelte-t9pcmp"),u(e,"class","prompts-modal svelte-t9pcmp")},m(g,p){H(g,e,p),o(e,t),o(t,s),o(s,r),o(t,a),o(t,i),o(e,f),y&&y.m(e,null),o(e,m),o(e,b);for(let _=0;_<D.length;_+=1)D[_]&&D[_].m(b,null);V||(M=F(i,"click",l[12]),V=!0)},p(g,p){if(p&1&&n!==(n=Bt(g[0])+"")&&Z(r,n),g[3]?y?y.p(g,p):(y=os(g),y.c(),y.m(e,m)):y&&(y.d(1),y=null),p&33){E=Je(Dt[g[0]]);let _;for(_=0;_<E.length;_+=1){const k=ss(g,E,_);D[_]?D[_].p(k,p):(D[_]=is(k),D[_].c(),D[_].m(b,null))}for(;_<D.length;_+=1)D[_].d(1);D.length=E.length}},d(g){g&&d(e),y&&y.d(),ot(D,g),V=!1,M()}}}function os(l){let e,t,s='<span class="sparkle svelte-t9pcmp">‚ú®</span> <span>Random Prompt</span>',n,r,a,i,c;return{c(){e=v("div"),t=v("div"),t.innerHTML=s,n=S(),r=v("button"),a=U(l[3]),this.h()},l(f){e=h(f,"DIV",{class:!0});var m=C(e);t=h(m,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-ps1841"&&(t.innerHTML=s),n=I(m),r=h(m,"BUTTON",{class:!0,type:!0});var b=C(r);a=A(b,l[3]),b.forEach(d),m.forEach(d),this.h()},h(){u(t,"class","random-prompt-header svelte-t9pcmp"),u(r,"class","random-prompt-btn svelte-t9pcmp"),u(r,"type","button"),u(e,"class","random-prompt-section svelte-t9pcmp")},m(f,m){H(f,e,m),o(e,t),o(e,n),o(e,r),o(r,a),i||(c=F(r,"click",l[13]),i=!0)},p(f,m){m&8&&Z(a,f[3])},d(f){f&&d(e),i=!1,c()}}}function is(l){let e,t=l[15]+"",s,n,r,a;function i(){return l[14](l[15])}return{c(){e=v("button"),s=U(t),n=S(),this.h()},l(c){e=h(c,"BUTTON",{class:!0,type:!0});var f=C(e);s=A(f,t),n=I(f),f.forEach(d),this.h()},h(){u(e,"class","prompt-item svelte-t9pcmp"),u(e,"type","button")},m(c,f){H(c,e,f),o(e,s),o(e,n),r||(a=F(e,"click",i),r=!0)},p(c,f){l=c,f&1&&t!==(t=l[15]+"")&&Z(s,t)},d(c){c&&d(e),r=!1,a()}}}function yl(l){let e,t,s,n='<span class="prompts-hint svelte-t9pcmp">üí° Click a category or use Random to get started</span>',r,a,i='<span class="random-icon svelte-t9pcmp">‚ú®</span> <span class="random-label svelte-t9pcmp">Random Prompt</span>',c,f,m,b,V=l[4]?"‚ñº":"‚ñ≤",M,y,E,D,g,p=Je(Object.keys(Dt)),_=[];for(let w=0;w<p.length;w+=1)_[w]=rs(ls(l,p,w));let k=l[2]&&as(l);return{c(){e=v("div"),t=v("div"),s=v("div"),s.innerHTML=n,r=S(),a=v("button"),a.innerHTML=i,c=S(),f=v("div");for(let w=0;w<_.length;w+=1)_[w].c();m=S(),b=v("button"),M=U(V),E=S(),k&&k.c(),this.h()},l(w){e=h(w,"DIV",{class:!0});var N=C(e);t=h(N,"DIV",{class:!0});var T=C(t);s=h(T,"DIV",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-1n1fysu"&&(s.innerHTML=n),r=I(T),a=h(T,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(a)!=="svelte-k8fpa3"&&(a.innerHTML=i),c=I(T),f=h(T,"DIV",{class:!0});var P=C(f);for(let W=0;W<_.length;W+=1)_[W].l(P);P.forEach(d),m=I(T),b=h(T,"BUTTON",{class:!0,title:!0,type:!0});var L=C(b);M=A(L,V),L.forEach(d),T.forEach(d),E=I(N),k&&k.l(N),N.forEach(d),this.h()},h(){u(s,"class","prompts-intro svelte-t9pcmp"),u(a,"class","random-prompt-header-btn svelte-t9pcmp"),u(a,"title","Get a random writing prompt to help you start"),u(a,"type","button"),u(f,"class","categories-bar svelte-t9pcmp"),Y(f,"collapsed",l[4]),u(b,"class","collapse-toggle svelte-t9pcmp"),u(b,"title",y=l[4]?"Show prompts":"Hide prompts"),u(b,"type","button"),u(t,"class","prompts-header-bar svelte-t9pcmp"),u(e,"class","prompts-container svelte-t9pcmp")},m(w,N){H(w,e,N),o(e,t),o(t,s),o(t,r),o(t,a),o(t,c),o(t,f);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(f,null);o(t,m),o(t,b),o(b,M),o(e,E),k&&k.m(e,null),D||(g=[F(a,"click",l[7]),F(b,"click",l[6])],D=!0)},p(w,[N]){if(N&279){p=Je(Object.keys(Dt));let T;for(T=0;T<p.length;T+=1){const P=ls(w,p,T);_[T]?_[T].p(P,N):(_[T]=rs(P),_[T].c(),_[T].m(f,null))}for(;T<_.length;T+=1)_[T].d(1);_.length=p.length}N&16&&Y(f,"collapsed",w[4]),N&16&&V!==(V=w[4]?"‚ñº":"‚ñ≤")&&Z(M,V),N&16&&y!==(y=w[4]?"Show prompts":"Hide prompts")&&u(b,"title",y),w[2]?k?k.p(w,N):(k=as(w),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},i:Ve,o:Ve,d(w){w&&d(e),ot(_,w),k&&k.d(),D=!1,tt(g)}}}function Bt(l){return{daily:"Daily Check-in",reflection:"Deep Reflection",emotional:"Emotions",relationships:"Relationships",challenges:"Challenges",homesickness:"Homesickness"}[l]||l}function bl(l){return{daily:"üìÖ",reflection:"üí≠",emotional:"üíô",relationships:"ü§ù",challenges:"üí™",homesickness:"üè†"}[l]||"‚ú®"}function kl(l,e,t){let{onSelectPrompt:s=null}=e,{selectedCategory:n="daily"}=e,{onCategoryChange:r=null}=e,{showLabels:a=!1}=e,i=!1,c="",f=!1;function m(p){s&&s(p),t(2,i=!1),t(4,f=!0)}function b(){t(4,f=!f),f||t(2,i=!1)}function V(){t(3,c=ts()),s&&s(c),t(2,i=!1),t(4,f=!0)}function M(p){t(0,n=p),r&&r(p)}const y=p=>{M(p),t(2,i=!0),t(4,f=!1)},E=()=>t(2,i=!1),D=()=>m(c),g=p=>m(p);return l.$$set=p=>{"onSelectPrompt"in p&&t(9,s=p.onSelectPrompt),"selectedCategory"in p&&t(0,n=p.selectedCategory),"onCategoryChange"in p&&t(10,r=p.onCategoryChange),"showLabels"in p&&t(1,a=p.showLabels)},l.$$.update=()=>{l.$$.dirty&4&&i&&t(3,c=ts())},[n,a,i,c,f,m,b,V,M,s,r,y,E,D,g]}class Jt extends ft{constructor(e){super(),dt(this,e,kl,yl,ut,{onSelectPrompt:9,selectedCategory:0,onCategoryChange:10,showLabels:1})}}function cs(l){let e,t,s,n,r;function a(f,m){return f[2]==="success"?Dl:f[2]==="error"?wl:Cl}let i=a(l),c=i(l);return{c(){e=v("div"),t=v("span"),c.c(),s=S(),n=v("span"),r=U(l[1]),this.h()},l(f){e=h(f,"DIV",{class:!0});var m=C(e);t=h(m,"SPAN",{class:!0});var b=C(t);c.l(b),b.forEach(d),s=I(m),n=h(m,"SPAN",{class:!0});var V=C(n);r=A(V,l[1]),V.forEach(d),m.forEach(d),this.h()},h(){u(t,"class","toast-icon svelte-15ndum8"),u(n,"class","toast-message svelte-15ndum8"),u(e,"class","toast svelte-15ndum8"),Y(e,"success",l[2]==="success"),Y(e,"info",l[2]==="info"),Y(e,"error",l[2]==="error")},m(f,m){H(f,e,m),o(e,t),c.m(t,null),o(e,s),o(e,n),o(n,r)},p(f,m){i!==(i=a(f))&&(c.d(1),c=i(f),c&&(c.c(),c.m(t,null))),m&2&&Z(r,f[1]),m&4&&Y(e,"success",f[2]==="success"),m&4&&Y(e,"info",f[2]==="info"),m&4&&Y(e,"error",f[2]==="error")},d(f){f&&d(e),c.d()}}}function Cl(l){let e;return{c(){e=U("‚ÑπÔ∏è")},l(t){e=A(t,"‚ÑπÔ∏è")},m(t,s){H(t,e,s)},d(t){t&&d(e)}}}function wl(l){let e;return{c(){e=U("‚úï")},l(t){e=A(t,"‚úï")},m(t,s){H(t,e,s)},d(t){t&&d(e)}}}function Dl(l){let e;return{c(){e=U("‚úì")},l(t){e=A(t,"‚úì")},m(t,s){H(t,e,s)},d(t){t&&d(e)}}}function El(l){let e,t=l[0]&&l[1]&&cs(l);return{c(){t&&t.c(),e=at()},l(s){t&&t.l(s),e=at()},m(s,n){t&&t.m(s,n),H(s,e,n)},p(s,[n]){s[0]&&s[1]?t?t.p(s,n):(t=cs(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ve,o:Ve,d(s){s&&d(e),t&&t.d(s)}}}function Il(l,e,t){let{message:s=""}=e,{type:n="success"}=e,{duration:r=2e3}=e,{visible:a=!1}=e,i;return mt(()=>()=>{clearTimeout(i)}),l.$$set=c=>{"message"in c&&t(1,s=c.message),"type"in c&&t(2,n=c.type),"duration"in c&&t(3,r=c.duration),"visible"in c&&t(0,a=c.visible)},l.$$.update=()=>{l.$$.dirty&27&&a&&s&&(clearTimeout(i),t(4,i=setTimeout(()=>{t(0,a=!1)},r)))},[a,s,n,r,i]}class Sl extends ft{constructor(e){super(),dt(this,e,Il,El,ut,{message:1,type:2,duration:3,visible:0})}}function us(l,e,t){const s=l.slice();return s[75]=e[t],s}function fs(l){let e,t,s,n,r="Select Date",a,i,c="√ó",f,m,b,V,M,y,E=l[16].length>0&&ds(l);return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("h3"),n.textContent=r,a=S(),i=v("button"),i.textContent=c,f=S(),m=v("div"),b=v("input"),V=S(),E&&E.c(),this.h()},l(D){e=h(D,"DIV",{class:!0});var g=C(e);t=h(g,"DIV",{class:!0});var p=C(t);s=h(p,"DIV",{class:!0});var _=C(s);n=h(_,"H3",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-8yofwe"&&(n.textContent=r),a=I(_),i=h(_,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-rz5ek5"&&(i.textContent=c),_.forEach(d),f=I(p),m=h(p,"DIV",{class:!0});var k=C(m);b=h(k,"INPUT",{type:!0,class:!0}),V=I(k),E&&E.l(k),k.forEach(d),p.forEach(d),g.forEach(d),this.h()},h(){u(n,"class","svelte-1u3e5rh"),u(i,"class","close-calendar svelte-1u3e5rh"),u(i,"type","button"),u(s,"class","calendar-header svelte-1u3e5rh"),u(b,"type","date"),u(b,"class","calendar-input svelte-1u3e5rh"),u(m,"class","calendar-body"),u(t,"class","calendar svelte-1u3e5rh"),u(e,"class","calendar-overlay svelte-1u3e5rh")},m(D,g){H(D,e,g),o(e,t),o(t,s),o(s,n),o(s,a),o(s,i),o(t,f),o(t,m),o(m,b),Ye(b,l[0]),o(m,V),E&&E.m(m,null),M||(y=[F(i,"click",et(l[22])),F(b,"input",l[41]),F(b,"change",l[21])],M=!0)},p(D,g){g[0]&1&&Ye(b,D[0]),D[16].length>0?E?E.p(D,g):(E=ds(D),E.c(),E.m(m,null)):E&&(E.d(1),E=null)},d(D){D&&d(e),E&&E.d(),M=!1,tt(y)}}}function ds(l){let e,t,s="Dates with entries:",n,r,a=Je(l[16]),i=[];for(let c=0;c<a.length;c+=1)i[c]=hs(us(l,a,c));return{c(){e=v("div"),t=v("h4"),t.textContent=s,n=S(),r=v("div");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=h(c,"DIV",{class:!0});var f=C(e);t=h(f,"H4",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1p0gze7"&&(t.textContent=s),n=I(f),r=h(f,"DIV",{class:!0});var m=C(r);for(let b=0;b<i.length;b+=1)i[b].l(m);m.forEach(d),f.forEach(d),this.h()},h(){u(t,"class","svelte-1u3e5rh"),u(r,"class","entry-dates svelte-1u3e5rh"),u(e,"class","entries-list svelte-1u3e5rh")},m(c,f){H(c,e,f),o(e,t),o(e,n),o(e,r);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(r,null)},p(c,f){if(f[0]&1114113){a=Je(c[16]);let m;for(m=0;m<a.length;m+=1){const b=us(c,a,m);i[m]?i[m].p(b,f):(i[m]=hs(b),i[m].c(),i[m].m(r,null))}for(;m<i.length;m+=1)i[m].d(1);i.length=a.length}},d(c){c&&d(e),ot(i,c)}}}function hs(l){let e,t=_t(l[75])+"",s,n,r,a;function i(){return l[42](l[75])}return{c(){e=v("button"),s=U(t),n=S(),this.h()},l(c){e=h(c,"BUTTON",{class:!0,type:!0});var f=C(e);s=A(f,t),n=I(f),f.forEach(d),this.h()},h(){u(e,"class","entry-date-btn svelte-1u3e5rh"),u(e,"type","button"),Y(e,"active",l[75]===l[0])},m(c,f){H(c,e,f),o(e,s),o(e,n),r||(a=F(e,"click",i),r=!0)},p(c,f){l=c,f[0]&65536&&t!==(t=_t(l[75])+"")&&Z(s,t),f[0]&65537&&Y(e,"active",l[75]===l[0])},d(c){c&&d(e),r=!1,a()}}}function vs(l){let e,t="üóëÔ∏è",s,n;return{c(){e=v("button"),e.textContent=t,this.h()},l(r){e=h(r,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(e)!=="svelte-1n8kt0u"&&(e.textContent=t),this.h()},h(){u(e,"class","delete-btn"),u(e,"title","Delete entry"),u(e,"type","button")},m(r,a){H(r,e,a),s||(n=F(e,"click",et(l[45])),s=!0)},p:Ve,d(r){r&&d(e),s=!1,n()}}}function ms(l){let e,t="üóëÔ∏è",s,n;return{c(){e=v("button"),e.textContent=t,this.h()},l(r){e=h(r,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(e)!=="svelte-1t3g4qf"&&(e.textContent=t),this.h()},h(){u(e,"class","delete-btn"),u(e,"title","Delete entry"),u(e,"type","button")},m(r,a){H(r,e,a),s||(n=F(e,"click",et(l[52])),s=!0)},p:Ve,d(r){r&&d(e),s=!1,n()}}}function ps(l){let e,t,s,n='<h3 class="svelte-1u3e5rh">Delete Entry?</h3>',r,a,i,c,f,m=_t(l[6])+"",b,V,M,y,E="This action cannot be undone.",D,g,p,_="Cancel",k,w,N="Delete",T,P;return{c(){e=v("div"),t=v("div"),s=v("div"),s.innerHTML=n,r=S(),a=v("div"),i=v("p"),c=U("Are you sure you want to delete the entry for "),f=v("strong"),b=U(m),V=U("?"),M=S(),y=v("p"),y.textContent=E,D=S(),g=v("div"),p=v("button"),p.textContent=_,k=S(),w=v("button"),w.textContent=N,this.h()},l(L){e=h(L,"DIV",{class:!0});var W=C(e);t=h(W,"DIV",{class:!0});var B=C(t);s=h(B,"DIV",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-dr0j76"&&(s.innerHTML=n),r=I(B),a=h(B,"DIV",{class:!0});var $=C(a);i=h($,"P",{class:!0});var le=C(i);c=A(le,"Are you sure you want to delete the entry for "),f=h(le,"STRONG",{});var Q=C(f);b=A(Q,m),Q.forEach(d),V=A(le,"?"),le.forEach(d),M=I($),y=h($,"P",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-p1ex8w"&&(y.textContent=E),$.forEach(d),D=I(B),g=h(B,"DIV",{class:!0});var ne=C(g);p=h(ne,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(p)!=="svelte-13zustw"&&(p.textContent=_),k=I(ne),w=h(ne,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(w)!=="svelte-19jnr51"&&(w.textContent=N),ne.forEach(d),B.forEach(d),W.forEach(d),this.h()},h(){u(s,"class","delete-confirm-header svelte-1u3e5rh"),u(i,"class","svelte-1u3e5rh"),u(y,"class","delete-warning svelte-1u3e5rh"),u(a,"class","delete-confirm-body svelte-1u3e5rh"),u(p,"class","delete-cancel-btn svelte-1u3e5rh"),u(p,"type","button"),u(w,"class","delete-confirm-btn svelte-1u3e5rh"),u(w,"type","button"),u(g,"class","delete-confirm-actions svelte-1u3e5rh"),u(t,"class","delete-confirm-modal svelte-1u3e5rh"),u(e,"class","delete-confirm-overlay svelte-1u3e5rh")},m(L,W){H(L,e,W),o(e,t),o(t,s),o(t,r),o(t,a),o(a,i),o(i,c),o(i,f),o(f,b),o(i,V),o(a,M),o(a,y),o(t,D),o(t,g),o(g,p),o(g,k),o(g,w),T||(P=[F(p,"click",l[33]),F(w,"click",l[32])],T=!0)},p(L,W){W[0]&64&&m!==(m=_t(L[6])+"")&&Z(b,m)},d(L){L&&d(e),T=!1,tt(P)}}}function gs(l){let e,t,s,n="üí¨ Talk about this day",r,a;return{c(){e=v("div"),t=v("div"),s=v("button"),s.textContent=n,this.h()},l(i){e=h(i,"DIV",{class:!0});var c=C(e);t=h(c,"DIV",{class:!0,style:!0});var f=C(t);s=h(f,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(s)!=="svelte-bmlg4p"&&(s.textContent=n),f.forEach(d),c.forEach(d),this.h()},h(){u(s,"class","context-menu-item svelte-1u3e5rh"),u(s,"type","button"),u(t,"class","context-menu svelte-1u3e5rh"),Ue(t,"left",l[13]+"px"),Ue(t,"top",l[14]+"px"),u(e,"class","context-menu-overlay svelte-1u3e5rh")},m(i,c){H(i,e,c),o(e,t),o(t,s),r||(a=[F(s,"click",l[58]),F(t,"click",jt(l[40])),F(e,"click",l[25]),F(e,"contextmenu",et(l[25]))],r=!0)},p(i,c){c[0]&8192&&Ue(t,"left",i[13]+"px"),c[0]&16384&&Ue(t,"top",i[14]+"px")},d(i){i&&d(e),r=!1,tt(a)}}}function Tl(l){let e,t,s,n="üìÖ",r,a,i,c,f,m,b,V='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"></path></svg>',M,y,E,D,g,p,_,k=l[7].starred?"‚≠ê":"‚òÜ",w,N,T,P,L=l[7].isPrivate?"üîí":"üîì",W,B,$,le=l[2].trim(),Q,ne,K,x,z,ce,ue,oe,be,_e,qe,Me,we,Ne,He,ee,me=l[8].starred?"‚≠ê":"‚òÜ",je,De,Ee,fe,he=l[8].isPrivate?"üîí":"üîì",Le,O,G,se,Te,Ce=_t(l[1])+"",R,q,re,ie=l[3].trim(),de,Se,Be='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"></path></svg>',Ze,Re,Qe,pe,ae,Ae,ke,ge,ye,j,X,Ie,ze,Pe,$e,it,We=l[4]&&fs(l),Oe=le&&vs(l);function bt(te){l[48](te)}let ht={onSelectPrompt:l[34],onCategoryChange:l[36],showLabels:!1};l[15]!==void 0&&(ht.selectedCategory=l[15]),ue=new Jt({props:ht}),vt.push(()=>At(ue,"selectedCategory",bt));let Ge=ie&&ms(l);function Tt(te){l[55](te)}let It={onSelectPrompt:l[35],onCategoryChange:l[36],showLabels:!1};l[15]!==void 0&&(It.selectedCategory=l[15]),ke=new Jt({props:It}),vt.push(()=>At(ke,"selectedCategory",Tt));let Ke=l[5]&&ps(l);function vl(te){l[57](te)}let Kt={message:l[9],type:l[11]};l[10]!==void 0&&(Kt.visible=l[10]),X=new Sl({props:Kt}),vt.push(()=>At(X,"visible",vl));let xe=l[12]&&gs(l);return{c(){e=v("div"),t=v("div"),s=v("button"),s.textContent=n,r=S(),a=v("div"),We&&We.c(),i=S(),c=v("div"),f=v("div"),m=v("div"),b=v("button"),b.innerHTML=V,M=S(),y=v("div"),E=v("h2"),D=U(l[17]),g=S(),p=v("div"),_=v("button"),w=U(k),T=S(),P=v("button"),W=U(L),$=S(),Oe&&Oe.c(),Q=S(),ne=v("div"),K=v("div"),x=S(),z=v("textarea"),ce=S(),rt(ue.$$.fragment),be=S(),_e=v("div"),qe=S(),Me=v("div"),we=v("div"),Ne=v("div"),He=v("div"),ee=v("button"),je=U(me),Ee=S(),fe=v("button"),Le=U(he),G=S(),se=v("div"),Te=v("h2"),R=U(Ce),q=S(),re=v("div"),Ge&&Ge.c(),de=S(),Se=v("button"),Se.innerHTML=Be,Ze=S(),Re=v("div"),Qe=v("div"),pe=S(),ae=v("textarea"),Ae=S(),rt(ke.$$.fragment),ye=S(),Ke&&Ke.c(),j=S(),rt(X.$$.fragment),ze=S(),xe&&xe.c(),this.h()},l(te){e=h(te,"DIV",{class:!0});var ve=C(e);t=h(ve,"DIV",{class:!0});var St=C(t);s=h(St,"BUTTON",{class:!0,type:!0,title:!0,"data-svelte-h":!0}),J(s)!=="svelte-z6u19h"&&(s.textContent=n),St.forEach(d),r=I(ve),a=h(ve,"DIV",{class:!0});var ct=C(a);We&&We.l(ct),i=I(ct),c=h(ct,"DIV",{class:!0});var yt=C(c);f=h(yt,"DIV",{class:!0});var Vt=C(f);m=h(Vt,"DIV",{class:!0});var pt=C(m);b=h(pt,"BUTTON",{class:!0,"aria-label":!0,type:!0,"data-svelte-h":!0}),J(b)!=="svelte-7jvwrf"&&(b.innerHTML=V),M=I(pt),y=h(pt,"DIV",{class:!0});var Wt=C(y);E=h(Wt,"H2",{class:!0});var qt=C(E);D=A(qt,l[17]),qt.forEach(d),Wt.forEach(d),g=I(pt),p=h(pt,"DIV",{class:!0});var Mt=C(p);_=h(Mt,"BUTTON",{class:!0,title:!0,type:!0});var Yt=C(_);w=A(Yt,k),Yt.forEach(d),T=I(Mt),P=h(Mt,"BUTTON",{class:!0,title:!0,type:!0});var Gt=C(P);W=A(Gt,L),Gt.forEach(d),Mt.forEach(d),$=I(pt),Oe&&Oe.l(pt),pt.forEach(d),Q=I(Vt),ne=h(Vt,"DIV",{class:!0});var kt=C(ne);K=h(kt,"DIV",{class:!0}),C(K).forEach(d),x=I(kt),z=h(kt,"TEXTAREA",{placeholder:!0,class:!0}),C(z).forEach(d),ce=I(kt),nt(ue.$$.fragment,kt),kt.forEach(d),Vt.forEach(d),yt.forEach(d),be=I(ct),_e=h(ct,"DIV",{class:!0}),C(_e).forEach(d),qe=I(ct),Me=h(ct,"DIV",{class:!0});var Xt=C(Me);we=h(Xt,"DIV",{class:!0});var Nt=C(we);Ne=h(Nt,"DIV",{class:!0});var Ct=C(Ne);He=h(Ct,"DIV",{class:!0});var Pt=C(He);ee=h(Pt,"BUTTON",{class:!0,title:!0,type:!0});var Qt=C(ee);je=A(Qt,me),Qt.forEach(d),Ee=I(Pt),fe=h(Pt,"BUTTON",{class:!0,title:!0,type:!0});var Zt=C(fe);Le=A(Zt,he),Zt.forEach(d),Pt.forEach(d),G=I(Ct),se=h(Ct,"DIV",{class:!0});var xt=C(se);Te=h(xt,"H2",{class:!0});var $t=C(Te);R=A($t,Ce),$t.forEach(d),xt.forEach(d),q=I(Ct),re=h(Ct,"DIV",{style:!0});var Ot=C(re);Ge&&Ge.l(Ot),de=I(Ot),Se=h(Ot,"BUTTON",{class:!0,"aria-label":!0,type:!0,"data-svelte-h":!0}),J(Se)!=="svelte-p9yxah"&&(Se.innerHTML=Be),Ot.forEach(d),Ct.forEach(d),Ze=I(Nt),Re=h(Nt,"DIV",{class:!0});var wt=C(Re);Qe=h(wt,"DIV",{class:!0}),C(Qe).forEach(d),pe=I(wt),ae=h(wt,"TEXTAREA",{placeholder:!0,class:!0}),C(ae).forEach(d),Ae=I(wt),nt(ke.$$.fragment,wt),wt.forEach(d),Nt.forEach(d),Xt.forEach(d),ct.forEach(d),ye=I(ve),Ke&&Ke.l(ve),j=I(ve),nt(X.$$.fragment,ve),ze=I(ve),xe&&xe.l(ve),ve.forEach(d),this.h()},h(){u(s,"class","calendar-toggle-top svelte-1u3e5rh"),u(s,"type","button"),u(s,"title","Open calendar"),u(t,"class","journal-header svelte-1u3e5rh"),u(b,"class","nav-arrow left-arrow svelte-1u3e5rh"),u(b,"aria-label","Previous day"),u(b,"type","button"),u(E,"class","date-title svelte-1u3e5rh"),u(y,"class","date-display svelte-1u3e5rh"),u(_,"class","star-btn"),u(_,"title",N=l[7].starred?"Unstar entry":"Star entry"),u(_,"type","button"),Y(_,"starred",l[7].starred),u(P,"class","private-btn svelte-1u3e5rh"),u(P,"title",B=l[7].isPrivate?"Entry is private (not shared with chatbot)":"Mark as private (exclude from chatbot)"),u(P,"type","button"),Y(P,"private",l[7].isPrivate),u(p,"class","entry-actions-left svelte-1u3e5rh"),u(m,"class","page-header svelte-1u3e5rh"),u(K,"class","entry-lines svelte-1u3e5rh"),u(z,"placeholder",""),u(z,"class","entry-textarea svelte-1u3e5rh"),u(ne,"class","entry-area svelte-1u3e5rh"),u(f,"class","page-content svelte-1u3e5rh"),u(c,"class","diary-page left-page svelte-1u3e5rh"),u(_e,"class","book-binding svelte-1u3e5rh"),u(ee,"class","star-btn"),u(ee,"title",De=l[8].starred?"Unstar entry":"Star entry"),u(ee,"type","button"),Y(ee,"starred",l[8].starred),u(fe,"class","private-btn svelte-1u3e5rh"),u(fe,"title",O=l[8].isPrivate?"Entry is private (not shared with chatbot)":"Mark as private (exclude from chatbot)"),u(fe,"type","button"),Y(fe,"private",l[8].isPrivate),u(He,"class","entry-actions-right svelte-1u3e5rh"),u(Te,"class","date-title svelte-1u3e5rh"),u(se,"class","date-display svelte-1u3e5rh"),u(Se,"class","nav-arrow right-arrow svelte-1u3e5rh"),u(Se,"aria-label","Next day"),u(Se,"type","button"),Ue(re,"display","flex"),Ue(re,"align-items","center"),Ue(re,"gap","0.5rem"),u(Ne,"class","page-header svelte-1u3e5rh"),u(Qe,"class","entry-lines svelte-1u3e5rh"),u(ae,"placeholder",""),u(ae,"class","entry-textarea svelte-1u3e5rh"),u(Re,"class","entry-area svelte-1u3e5rh"),u(we,"class","page-content svelte-1u3e5rh"),u(Me,"class","diary-page right-page svelte-1u3e5rh"),u(a,"class","diary-pages-container svelte-1u3e5rh"),u(e,"class","diary-book-container svelte-1u3e5rh")},m(te,ve){H(te,e,ve),o(e,t),o(t,s),o(e,r),o(e,a),We&&We.m(a,null),o(a,i),o(a,c),o(c,f),o(f,m),o(m,b),o(m,M),o(m,y),o(y,E),o(E,D),o(m,g),o(m,p),o(p,_),o(_,w),o(p,T),o(p,P),o(P,W),o(m,$),Oe&&Oe.m(m,null),o(f,Q),o(f,ne),o(ne,K),o(ne,x),o(ne,z),Ye(z,l[2]),o(ne,ce),lt(ue,ne,null),o(a,be),o(a,_e),o(a,qe),o(a,Me),o(Me,we),o(we,Ne),o(Ne,He),o(He,ee),o(ee,je),o(He,Ee),o(He,fe),o(fe,Le),o(Ne,G),o(Ne,se),o(se,Te),o(Te,R),o(Ne,q),o(Ne,re),Ge&&Ge.m(re,null),o(re,de),o(re,Se),o(we,Ze),o(we,Re),o(Re,Qe),o(Re,pe),o(Re,ae),Ye(ae,l[3]),o(Re,Ae),lt(ke,Re,null),o(e,ye),Ke&&Ke.m(e,null),o(e,j),lt(X,e,null),o(e,ze),xe&&xe.m(e,null),Pe=!0,$e||(it=[F(s,"click",et(l[22])),F(b,"click",jt(et(l[18]))),F(_,"click",et(l[43])),F(P,"click",et(l[44])),F(z,"input",l[46]),F(z,"input",l[26]),F(z,"contextmenu",et(l[47])),F(ne,"contextmenu",et(l[49])),F(ee,"click",et(l[50])),F(fe,"click",et(l[51])),F(Se,"click",jt(et(l[19]))),F(ae,"input",l[53]),F(ae,"input",l[27]),F(ae,"contextmenu",et(l[54])),F(Re,"contextmenu",et(l[56]))],$e=!0)},p(te,ve){te[4]?We?We.p(te,ve):(We=fs(te),We.c(),We.m(a,i)):We&&(We.d(1),We=null),(!Pe||ve[0]&131072)&&Z(D,te[17]),(!Pe||ve[0]&128)&&k!==(k=te[7].starred?"‚≠ê":"‚òÜ")&&Z(w,k),(!Pe||ve[0]&128&&N!==(N=te[7].starred?"Unstar entry":"Star entry"))&&u(_,"title",N),(!Pe||ve[0]&128)&&Y(_,"starred",te[7].starred),(!Pe||ve[0]&128)&&L!==(L=te[7].isPrivate?"üîí":"üîì")&&Z(W,L),(!Pe||ve[0]&128&&B!==(B=te[7].isPrivate?"Entry is private (not shared with chatbot)":"Mark as private (exclude from chatbot)"))&&u(P,"title",B),(!Pe||ve[0]&128)&&Y(P,"private",te[7].isPrivate),ve[0]&4&&(le=te[2].trim()),le?Oe?Oe.p(te,ve):(Oe=vs(te),Oe.c(),Oe.m(m,null)):Oe&&(Oe.d(1),Oe=null),ve[0]&4&&Ye(z,te[2]);const St={};!oe&&ve[0]&32768&&(oe=!0,St.selectedCategory=te[15],Lt(()=>oe=!1)),ue.$set(St),(!Pe||ve[0]&256)&&me!==(me=te[8].starred?"‚≠ê":"‚òÜ")&&Z(je,me),(!Pe||ve[0]&256&&De!==(De=te[8].starred?"Unstar entry":"Star entry"))&&u(ee,"title",De),(!Pe||ve[0]&256)&&Y(ee,"starred",te[8].starred),(!Pe||ve[0]&256)&&he!==(he=te[8].isPrivate?"üîí":"üîì")&&Z(Le,he),(!Pe||ve[0]&256&&O!==(O=te[8].isPrivate?"Entry is private (not shared with chatbot)":"Mark as private (exclude from chatbot)"))&&u(fe,"title",O),(!Pe||ve[0]&256)&&Y(fe,"private",te[8].isPrivate),(!Pe||ve[0]&2)&&Ce!==(Ce=_t(te[1])+"")&&Z(R,Ce),ve[0]&8&&(ie=te[3].trim()),ie?Ge?Ge.p(te,ve):(Ge=ms(te),Ge.c(),Ge.m(re,de)):Ge&&(Ge.d(1),Ge=null),ve[0]&8&&Ye(ae,te[3]);const ct={};!ge&&ve[0]&32768&&(ge=!0,ct.selectedCategory=te[15],Lt(()=>ge=!1)),ke.$set(ct),te[5]?Ke?Ke.p(te,ve):(Ke=ps(te),Ke.c(),Ke.m(e,j)):Ke&&(Ke.d(1),Ke=null);const yt={};ve[0]&512&&(yt.message=te[9]),ve[0]&2048&&(yt.type=te[11]),!Ie&&ve[0]&1024&&(Ie=!0,yt.visible=te[10],Lt(()=>Ie=!1)),X.$set(yt),te[12]?xe?xe.p(te,ve):(xe=gs(te),xe.c(),xe.m(e,null)):xe&&(xe.d(1),xe=null)},i(te){Pe||(Fe(ue.$$.fragment,te),Fe(ke.$$.fragment,te),Fe(X.$$.fragment,te),Pe=!0)},o(te){Xe(ue.$$.fragment,te),Xe(ke.$$.fragment,te),Xe(X.$$.fragment,te),Pe=!1},d(te){te&&d(e),We&&We.d(),Oe&&Oe.d(),st(ue),Ge&&Ge.d(),st(ke),Ke&&Ke.d(),st(X),xe&&xe.d(),$e=!1,tt(it)}}}function _t(l){const e=new Date(l),t={weekday:"long",year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("en-US",t)}function Vl(l,e,t){let s,n;const r=dl(),a=new Et;let i="",c="",f="",m="",b=!1,V=!1,M="",y="",E={starred:!1,mood:null,wordCount:0,isPrivate:!1},D={starred:!1,mood:null,wordCount:0,isPrivate:!1},g="",p=!1,_="success",k=!1,w="",N=0,T=0;mt(()=>{t(0,i=a.formatDate())});function P(){if(!i)return;t(2,c=a.getEntry(i));const j=a.getMetadata(i);t(7,E={starred:j.starred||!1,mood:j.mood||null,wordCount:a.getWordCount(c),isPrivate:j.isPrivate||!1});const X=new Date(i+"T00:00:00"),Ie=new Date(X);Ie.setDate(Ie.getDate()+1),t(1,f=a.formatDate(Ie)),t(3,m=a.getEntry(f));const ze=a.getMetadata(f);t(8,D={starred:ze.starred||!1,mood:ze.mood||null,wordCount:a.getWordCount(m),isPrivate:ze.isPrivate||!1})}function L(){a.saveEntry(i,c)}function W(){a.saveEntry(f,m)}function B(j){j&&(j.preventDefault(),j.stopPropagation()),L(),W();const X=new Date(i+"T00:00:00");X.setDate(X.getDate()-2),t(0,i=a.formatDate(X))}function $(j){j&&(j.preventDefault(),j.stopPropagation()),L(),W();const X=new Date(i+"T00:00:00");X.setDate(X.getDate()+2),t(0,i=a.formatDate(X))}function le(j){L(),W(),t(0,i=a.formatDate(j)),t(4,b=!1)}function Q(j){L(),W(),t(0,i=j.target.value)}function ne(){t(4,b=!b)}function K(j,X,Ie){if(j.button===2){j.preventDefault();const ze=Ie==="left"?c:m;ze&&ze.trim()&&(w=X,t(13,N=j.clientX),t(14,T=j.clientY),t(12,k=!0))}}function x(j){j==="talkAboutDay"&&w&&(r("talkAboutDay",{date:w}),t(12,k=!1))}function z(){t(12,k=!1)}let ce,ue;function oe(j,X="success"){t(9,g=j),t(11,_=X),t(10,p=!0)}function be(){clearTimeout(ce),ce=setTimeout(()=>{if(c.trim()){a.saveEntry(i,c);const j=a.getWordCount(c);a.saveMetadata(i,{wordCount:j}),t(7,E.wordCount=j,E),oe("Entry saved","success")}else a.deleteEntry(i);r("entrySaved")},500)}function _e(){clearTimeout(ue),ue=setTimeout(()=>{if(m.trim()){a.saveEntry(f,m);const j=a.getWordCount(m);a.saveMetadata(f,{wordCount:j}),t(8,D.wordCount=j,D),oe("Entry saved","success")}else a.deleteEntry(f);r("entrySaved")},500)}function qe(j){const X=j==="left"?i:f,Ie=a.toggleStar(X);j==="left"?t(7,E.starred=Ie,E):t(8,D.starred=Ie,D)}function Me(j){const X=j==="left"?i:f,ze=!a.getMetadata(X).isPrivate;a.saveMetadata(X,{isPrivate:ze}),j==="left"?t(7,E.isPrivate=ze,E):t(8,D.isPrivate=ze,D),oe(ze?"Entry marked as private":"Entry marked as public","info")}function we(j,X){X&&(a.setMood(j,X),j===i?t(7,E.mood=X,E):j===f&&t(8,D.mood=X,D))}function Ne(j,X){we(j,X),P()}function He(){t(6,M=i),y="left",t(5,V=!0)}function ee(){t(6,M=f),y="right",t(5,V=!0)}function me(){M&&(a.deleteEntry(M),y==="left"?t(2,c=""):y==="right"&&t(3,m=""),r("entrySaved"),t(5,V=!1),t(6,M=""),y="")}function je(){t(5,V=!1),t(6,M=""),y=""}let De="daily";function Ee(j){c.trim()?t(2,c+=`

`+j+" "):t(2,c=j+" "),be(),setTimeout(()=>{const X=document.querySelector(".entry-textarea");X&&X.focus()},100)}function fe(j){m.trim()?t(3,m+=`

`+j+" "):t(3,m=j+" "),_e(),setTimeout(()=>{const X=document.querySelectorAll(".entry-textarea");X&&X.length>1&&X[1].focus()},100)}function he(j){t(15,De=j)}function Le(){const j=a.getAllEntries();return Object.keys(j).filter(X=>j[X].trim().length>0).sort((X,Ie)=>new Date(Ie+"T00:00:00")-new Date(X+"T00:00:00"))}function O(){return a.getContextForAgents()}function G(){return i}function se(j){ml.call(this,l,j)}function Te(){i=this.value,t(0,i)}const Ce=j=>le(new Date(j)),R=()=>qe("left"),q=()=>Me("left"),re=()=>He();function ie(){c=this.value,t(2,c)}const de=j=>K(j,i,"left");function Se(j){De=j,t(15,De)}const Be=j=>K(j,i,"left"),Ze=()=>qe("right"),Re=()=>Me("right"),Qe=()=>ee();function pe(){m=this.value,t(3,m)}const ae=j=>K(j,f,"right");function Ae(j){De=j,t(15,De)}const ke=j=>K(j,f,"right");function ge(j){p=j,t(10,p)}const ye=()=>x("talkAboutDay");return l.$$.update=()=>{l.$$.dirty[0]&1&&t(17,s=i?_t(i):""),l.$$.dirty[0]&2&&f&&_t(f),l.$$.dirty[0]&1&&i&&P()},t(16,n=Le()),[i,f,c,m,b,V,M,E,D,g,p,_,k,N,T,De,n,s,B,$,le,Q,ne,K,x,z,be,_e,qe,Me,He,ee,me,je,Ee,fe,he,Ne,O,G,se,Te,Ce,R,q,re,ie,de,Se,Be,Ze,Re,Qe,pe,ae,Ae,ke,ge,ye]}class Ml extends ft{constructor(e){super(),dt(this,e,Vl,Tl,ut,{updateMoodForDate:37,getDiaryContext:38,getCurrentDate:39},null,[-1,-1,-1])}get updateMoodForDate(){return this.$$.ctx[37]}get getDiaryContext(){return this.$$.ctx[38]}get getCurrentDate(){return this.$$.ctx[39]}}function Nl(l){let e,t=l[0].content+"",s,n,r,a,i="üëç",c,f,m="üëé",b,V;return{c(){e=v("div"),s=U(t),n=S(),r=v("div"),a=v("button"),a.textContent=i,c=S(),f=v("button"),f.textContent=m,this.h()},l(M){e=h(M,"DIV",{class:!0});var y=C(e);s=A(y,t),n=I(y),r=h(y,"DIV",{class:!0});var E=C(r);a=h(E,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(a)!=="svelte-1y1rc68"&&(a.textContent=i),c=I(E),f=h(E,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(f)!=="svelte-1w08uys"&&(f.textContent=m),E.forEach(d),y.forEach(d),this.h()},h(){u(a,"class","feedback-btn svelte-1nhtrfb"),u(a,"title","This response was helpful"),u(a,"type","button"),Y(a,"active",l[3]==="helpful"),u(f,"class","feedback-btn svelte-1nhtrfb"),u(f,"title","This response was not helpful"),u(f,"type","button"),Y(f,"active",l[3]==="not-helpful"),u(r,"class","feedback-buttons svelte-1nhtrfb"),u(e,"class","bubble assistant svelte-1nhtrfb"),Y(e,"reflection-mode",l[1]==="reflection"),Y(e,"validator-mode",l[1]==="validator"),Y(e,"conflict-mode",l[1]==="conflict"),Y(e,"visible",l[2])},m(M,y){H(M,e,y),o(e,s),o(e,n),o(e,r),o(r,a),o(r,c),o(r,f),b||(V=[F(a,"click",l[5]),F(f,"click",l[6])],b=!0)},p(M,y){y&1&&t!==(t=M[0].content+"")&&Z(s,t),y&8&&Y(a,"active",M[3]==="helpful"),y&8&&Y(f,"active",M[3]==="not-helpful"),y&2&&Y(e,"reflection-mode",M[1]==="reflection"),y&2&&Y(e,"validator-mode",M[1]==="validator"),y&2&&Y(e,"conflict-mode",M[1]==="conflict"),y&4&&Y(e,"visible",M[2])},d(M){M&&d(e),b=!1,tt(V)}}}function Pl(l){let e,t=l[0].content+"",s;return{c(){e=v("div"),s=U(t),this.h()},l(n){e=h(n,"DIV",{class:!0});var r=C(e);s=A(r,t),r.forEach(d),this.h()},h(){u(e,"class","bubble user svelte-1nhtrfb")},m(n,r){H(n,e,r),o(e,s)},p(n,r){r&1&&t!==(t=n[0].content+"")&&Z(s,t)},d(n){n&&d(e)}}}function Ol(l){let e;function t(r,a){return r[0].role==="user"?Pl:Nl}let s=t(l),n=s(l);return{c(){e=v("div"),n.c(),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=C(e);n.l(a),a.forEach(d),this.h()},h(){u(e,"class","bubble-container svelte-1nhtrfb"),Y(e,"assistant",l[0].role==="assistant"),Y(e,"user",l[0].role==="user")},m(r,a){H(r,e,a),n.m(e,null)},p(r,[a]){s===(s=t(r))&&n?n.p(r,a):(n.d(1),n=s(r),n&&(n.c(),n.m(e,null))),a&1&&Y(e,"assistant",r[0].role==="assistant"),a&1&&Y(e,"user",r[0].role==="user")},i:Ve,o:Ve,d(r){r&&d(e),n.d()}}}function Ll(l,e,t){let{message:s}=e,{mode:n="reflection"}=e;const r=dl();let a=!1,i=null;function c(b){i||(t(3,i=b),r("feedback",{messageId:s.id||Date.now(),helpful:b==="helpful",mode:n}))}const f=()=>c("helpful"),m=()=>c("not-helpful");return l.$$set=b=>{"message"in b&&t(0,s=b.message),"mode"in b&&t(1,n=b.mode)},l.$$.update=()=>{l.$$.dirty&1&&(s.role==="assistant"?setTimeout(()=>{t(2,a=!0)},50):t(2,a=!0))},[s,n,a,i,c,f,m]}class Al extends ft{constructor(e){super(),dt(this,e,Ll,Ol,ut,{message:0,mode:1})}}class hl{constructor(){this.storageKey="diary_metrics_history"}saveMetricsHistory(e){if(!(typeof window>"u"))try{const t=this.getMetricsHistory();t.push(e);const s=t.slice(-100);localStorage.setItem(this.storageKey,JSON.stringify(s))}catch(t){console.error("Error saving metrics history:",t)}}getMetricsHistory(){if(typeof window>"u")return[];try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading metrics history:",e),[]}}getRecentMetrics(e=7){const t=this.getMetricsHistory(),s=new Date;return s.setDate(s.getDate()-e),t.filter(n=>new Date(n.timestamp)>=s)}getAverageStressLevel(e=7){const t=this.getRecentMetrics(e);return t.length===0?5:t.reduce((n,r)=>n+(r.stressLevel||5),0)/t.length}getAverageLonelinessLevel(e=7){const t=this.getRecentMetrics(e);return t.length===0?5:t.reduce((n,r)=>n+(r.lonelinessLevel||5),0)/t.length}getSentimentTrend(e=7){const t=this.getRecentMetrics(e);if(t.length<2)return"stable";t.filter(r=>r.sentiment==="positive").length,t.filter(r=>r.sentiment==="negative").length;const s=t.slice(0,Math.floor(t.length/2)).filter(r=>r.sentiment==="positive").length,n=t.slice(Math.floor(t.length/2)).filter(r=>r.sentiment==="positive").length;return n>s?"improving":n<s?"declining":"stable"}trackSentimentShift(e){var a,i;const t=e.slice(-4),s=["better","good","relieved","calm","thanks","helpful","understand","grateful","appreciate"],n=((i=(a=t[t.length-1])==null?void 0:a.content)==null?void 0:i.toLowerCase())||"";return s.some(c=>n.includes(c))}getEmotionalInsights(){const e=this.getRecentMetrics(7);if(e.length===0)return null;const t=this.getAverageStressLevel(7),s=this.getAverageLonelinessLevel(7),n=this.getSentimentTrend(7),r=e.filter(a=>a.encouragesConnection).length;return{avgStress:Math.round(t*10)/10,avgLoneliness:Math.round(s*10)/10,sentimentTrend:n,connectionEncouragements:r,totalInteractions:e.length}}}class Ul{constructor(){this.storageKey="chat_sessions",this.currentSessionKey="current_chat_session_id"}getAllSessions(){if(typeof window>"u")return[];try{const e=localStorage.getItem(this.storageKey);return(e?JSON.parse(e):[]).sort((s,n)=>new Date(n.lastUpdated)-new Date(s.lastUpdated))}catch(e){return console.error("Error reading chat sessions:",e),[]}}getSession(e){if(typeof window>"u")return null;try{return this.getAllSessions().find(s=>s.id===e)||null}catch(t){return console.error("Error reading chat session:",t),null}}getCurrentSessionId(){if(typeof window>"u")return null;try{return localStorage.getItem(this.currentSessionKey)}catch(e){return console.error("Error reading current session ID:",e),null}}setCurrentSessionId(e){if(!(typeof window>"u"))try{e?localStorage.setItem(this.currentSessionKey,e):localStorage.removeItem(this.currentSessionKey)}catch(t){console.error("Error saving current session ID:",t)}}createSession(e=null){if(typeof window>"u")return null;const t=`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=new Date().toISOString(),n={id:t,title:e||this.generateDefaultTitle(),messages:[],createdAt:s,lastUpdated:s,diaryContext:"",includeTodayEntry:!1};try{const r=this.getAllSessions();return r.push(n),localStorage.setItem(this.storageKey,JSON.stringify(r)),this.setCurrentSessionId(t),n}catch(r){return console.error("Error creating chat session:",r),null}}generateDefaultTitle(){const e=new Date().getHours();return`${e<12?"Morning":e<17?"Afternoon":"Evening"} Chat - ${new Date().toLocaleDateString()}`}updateSession(e,t){if(typeof window>"u")return!1;try{const s=this.getAllSessions(),n=s.findIndex(r=>r.id===e);return n===-1?!1:(s[n]={...s[n],...t,lastUpdated:new Date().toISOString()},localStorage.setItem(this.storageKey,JSON.stringify(s)),!0)}catch(s){return console.error("Error updating chat session:",s),!1}}addMessage(e,t){if(typeof window>"u")return!1;try{const s=this.getAllSessions(),n=s.findIndex(r=>r.id===e);if(n===-1)return!1;if(s[n].messages.push(t),s[n].lastUpdated=new Date().toISOString(),s[n].messages.length===2&&t.role==="user"&&(s[n].title.startsWith("Morning")||s[n].title.startsWith("Afternoon")||s[n].title.startsWith("Evening"))){const r=t.content.substring(0,50);s[n].title=r.length<t.content.length?`${r}...`:r}return localStorage.setItem(this.storageKey,JSON.stringify(s)),!0}catch(s){return console.error("Error adding message:",s),!1}}setMessages(e,t){var s;if(typeof window>"u")return!1;try{const n=this.getAllSessions(),r=n.findIndex(a=>a.id===e);if(r===-1)return!1;if(n[r].messages=t,n[r].lastUpdated=new Date().toISOString(),t.length===2&&((s=t[1])==null?void 0:s.role)==="user"&&(n[r].title.startsWith("Morning")||n[r].title.startsWith("Afternoon")||n[r].title.startsWith("Evening"))){const a=t[1].content.substring(0,50);n[r].title=a.length<t[1].content.length?`${a}...`:a}return localStorage.setItem(this.storageKey,JSON.stringify(n)),!0}catch(n){return console.error("Error setting messages:",n),!1}}deleteSession(e){if(typeof window>"u")return!1;try{const s=this.getAllSessions().filter(n=>n.id!==e);return localStorage.setItem(this.storageKey,JSON.stringify(s)),this.getCurrentSessionId()===e&&this.setCurrentSessionId(null),!0}catch(t){return console.error("Error deleting chat session:",t),!1}}getOrCreateCurrentSession(){let e=this.getCurrentSessionId(),t=e?this.getSession(e):null;return t||(t=this.createSession()),t}formatDate(e){const t=new Date(e),s=new Date,n=s-t,r=Math.floor(n/(1e3*60*60*24));return r===0?"Today":r===1?"Yesterday":r<7?`${r} days ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==s.getFullYear()?"numeric":void 0})}}function _s(l,e,t){const s=l.slice();return s[51]=e[t],s[53]=t,s}function ys(l,e,t){const s=l.slice();return s[54]=e[t],s}function bs(l,e,t){const s=l.slice();return s[57]=e[t],s}function Hl(l){const e=l.slice(),t=[...e[57].messages].reverse().find(s=>s.role==="user");return e[60]=t,e}function ks(l){let e,t,s=l[0]?"Diary Connected":"No Diary",n,r,a;return{c(){e=v("button"),t=U("üìñ "),n=U(s),this.h()},l(i){e=h(i,"BUTTON",{class:!0,title:!0});var c=C(e);t=A(c,"üìñ "),n=A(c,s),c.forEach(d),this.h()},h(){u(e,"class","diary-context-btn svelte-a6my4i"),u(e,"title","Show diary context being used")},m(i,c){H(i,e,c),o(e,t),o(e,n),r||(a=F(e,"click",l[31]),r=!0)},p(i,c){c[0]&1&&s!==(s=i[0]?"Diary Connected":"No Diary")&&Z(n,s)},d(i){i&&d(e),r=!1,a()}}}function Cs(l){let e,t;return{c(){e=v("div"),t=U(l[6]),this.h()},l(s){e=h(s,"DIV",{class:!0,role:!0});var n=C(e);t=A(n,l[6]),n.forEach(d),this.h()},h(){u(e,"class","error svelte-a6my4i"),u(e,"role","alert")},m(s,n){H(s,e,n),o(e,t)},p(s,n){n[0]&64&&Z(t,s[6])},d(s){s&&d(e)}}}function jl(l){let e,t="<p>No previous chats. Start a conversation!</p>";return{c(){e=v("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-w1fmyv"&&(e.innerHTML=t),this.h()},h(){u(e,"class","no-sessions svelte-a6my4i")},m(s,n){H(s,e,n)},p:Ve,d(s){s&&d(e)}}}function Bl(l){let e,t=Je(l[15]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ds(bs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=at()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=at()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);H(n,e,r)},p(n,r){if(r[0]&30646272){t=Je(n[15]);let a;for(a=0;a<t.length;a+=1){const i=bs(n,t,a);s[a]?s[a].p(i,r):(s[a]=Ds(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&d(e),ot(s,n)}}}function Rl(l){let e;return{c(){e=U("Empty chat")},l(t){e=A(t,"Empty chat")},m(t,s){H(t,e,s)},p:Ve,d(t){t&&d(e)}}}function ws(l){let e;function t(r,a){return r[60]?Fl:zl}let s=t(l),n=s(l);return{c(){n.c(),e=at()},l(r){n.l(r),e=at()},m(r,a){n.m(r,a),H(r,e,a)},p(r,a){s===(s=t(r))&&n?n.p(r,a):(n.d(1),n=s(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&d(e),n.d(r)}}}function zl(l){let e=l[57].messages.length+"",t,s,n=l[57].messages.length!==1?"s":"",r;return{c(){t=U(e),s=U(" message"),r=U(n)},l(a){t=A(a,e),s=A(a," message"),r=A(a,n)},m(a,i){H(a,t,i),H(a,s,i),H(a,r,i)},p(a,i){i[0]&32768&&e!==(e=a[57].messages.length+"")&&Z(t,e),i[0]&32768&&n!==(n=a[57].messages.length!==1?"s":"")&&Z(r,n)},d(a){a&&(d(t),d(s),d(r))}}}function Fl(l){let e=l[60].content.substring(0,60)+"",t,s=l[60].content.length>60?"...":"",n;return{c(){t=U(e),n=U(s)},l(r){t=A(r,e),n=A(r,s)},m(r,a){H(r,t,a),H(r,n,a)},p(r,a){a[0]&32768&&e!==(e=r[60].content.substring(0,60)+"")&&Z(t,e),a[0]&32768&&s!==(s=r[60].content.length>60?"...":"")&&Z(n,s)},d(r){r&&(d(t),d(n))}}}function Jl(l){let e,t="üóëÔ∏è",s,n;function r(...a){return l[34](l[57],...a)}return{c(){e=v("button"),e.textContent=t,this.h()},l(a){e=h(a,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(e)!=="svelte-19tuzwg"&&(e.textContent=t),this.h()},h(){u(e,"class","delete-session-btn svelte-a6my4i"),u(e,"title","Delete this chat")},m(a,i){H(a,e,i),s||(n=F(e,"click",r),s=!0)},p(a,i){l=a},d(a){a&&d(e),s=!1,n()}}}function Kl(l){let e,t,s="Delete?",n,r,a="‚úì",i,c,f="‚úï",m,b;function V(...M){return l[32](l[57],...M)}return{c(){e=v("div"),t=v("span"),t.textContent=s,n=S(),r=v("button"),r.textContent=a,i=S(),c=v("button"),c.textContent=f,this.h()},l(M){e=h(M,"DIV",{class:!0});var y=C(e);t=h(y,"SPAN",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1yne830"&&(t.textContent=s),n=I(y),r=h(y,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(r)!=="svelte-wckar2"&&(r.textContent=a),i=I(y),c=h(y,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(c)!=="svelte-1x11f9s"&&(c.textContent=f),y.forEach(d),this.h()},h(){u(t,"class","delete-text svelte-a6my4i"),u(r,"class","confirm-delete-btn svelte-a6my4i"),u(r,"title","Confirm delete"),u(c,"class","cancel-delete-btn svelte-a6my4i"),u(c,"title","Cancel"),u(e,"class","delete-confirmation svelte-a6my4i")},m(M,y){H(M,e,y),o(e,t),o(e,n),o(e,r),o(e,i),o(e,c),m||(b=[F(r,"click",V),F(c,"click",l[33])],m=!0)},p(M,y){l=M},d(M){M&&d(e),m=!1,tt(b)}}}function Ds(l){let e,t,s,n=l[57].title+"",r,a,i,c=l[17].formatDate(l[57].lastUpdated)+"",f,m,b,V,M,y,E;function D(P,L){return P[57].messages&&P[57].messages.length>0?ws:Rl}function g(P,L){return L===ws?Hl(P):P}let p=D(l),_=p(g(l,p));function k(P,L){return P[16]===P[57].id?Kl:Jl}let w=k(l),N=w(l);function T(){return l[35](l[57])}return{c(){e=v("div"),t=v("div"),s=v("div"),r=U(n),a=S(),i=v("div"),f=U(c),m=S(),b=v("div"),_.c(),V=S(),N.c(),M=S(),this.h()},l(P){e=h(P,"DIV",{class:!0});var L=C(e);t=h(L,"DIV",{class:!0});var W=C(t);s=h(W,"DIV",{class:!0});var B=C(s);r=A(B,n),B.forEach(d),a=I(W),i=h(W,"DIV",{class:!0});var $=C(i);f=A($,c),$.forEach(d),m=I(W),b=h(W,"DIV",{class:!0});var le=C(b);_.l(le),le.forEach(d),W.forEach(d),V=I(L),N.l(L),M=I(L),L.forEach(d),this.h()},h(){u(s,"class","session-title svelte-a6my4i"),u(i,"class","session-date svelte-a6my4i"),u(b,"class","session-preview svelte-a6my4i"),u(t,"class","session-info svelte-a6my4i"),u(e,"class","session-item svelte-a6my4i"),Y(e,"active",l[57].id===l[13]),Y(e,"deleting",l[16]===l[57].id)},m(P,L){H(P,e,L),o(e,t),o(t,s),o(s,r),o(t,a),o(t,i),o(i,f),o(t,m),o(t,b),_.m(b,null),o(e,V),N.m(e,null),o(e,M),y||(E=F(e,"click",T),y=!0)},p(P,L){l=P,L[0]&32768&&n!==(n=l[57].title+"")&&Z(r,n),L[0]&32768&&c!==(c=l[17].formatDate(l[57].lastUpdated)+"")&&Z(f,c),p===(p=D(l))&&_?_.p(g(l,p),L):(_.d(1),_=p(g(l,p)),_&&(_.c(),_.m(b,null))),w===(w=k(l))&&N?N.p(l,L):(N.d(1),N=w(l),N&&(N.c(),N.m(e,M))),L[0]&40960&&Y(e,"active",l[57].id===l[13]),L[0]&98304&&Y(e,"deleting",l[16]===l[57].id)},d(P){P&&d(e),_.d(),N.d(),y=!1,E()}}}function Es(l){let e,t,s,n,r="üìù Diary Context",a,i,c="√ó",f,m,b,V,M;function y(p,_){return p[0]?ql:Wl}let E=y(l),D=E(l),g=l[1]&&l[2]&&Is(l);return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("h3"),n.textContent=r,a=S(),i=v("button"),i.textContent=c,f=S(),m=v("div"),D.c(),b=S(),g&&g.c(),this.h()},l(p){e=h(p,"DIV",{class:!0});var _=C(e);t=h(_,"DIV",{class:!0});var k=C(t);s=h(k,"DIV",{class:!0});var w=C(s);n=h(w,"H3",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-1bat3vy"&&(n.textContent=r),a=I(w),i=h(w,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-1934z7m"&&(i.textContent=c),w.forEach(d),f=I(k),m=h(k,"DIV",{class:!0});var N=C(m);D.l(N),b=I(N),g&&g.l(N),N.forEach(d),k.forEach(d),_.forEach(d),this.h()},h(){u(n,"class","svelte-a6my4i"),u(i,"class","close-context-modal svelte-a6my4i"),u(i,"type","button"),u(s,"class","context-modal-header svelte-a6my4i"),u(m,"class","context-modal-body svelte-a6my4i"),u(t,"class","diary-context-modal-content svelte-a6my4i"),u(e,"class","diary-context-modal svelte-a6my4i")},m(p,_){H(p,e,_),o(e,t),o(t,s),o(s,n),o(s,a),o(s,i),o(t,f),o(t,m),D.m(m,null),o(m,b),g&&g.m(m,null),V||(M=F(i,"click",l[36]),V=!0)},p(p,_){E===(E=y(p))&&D?D.p(p,_):(D.d(1),D=E(p),D&&(D.c(),D.m(m,b))),p[1]&&p[2]?g?g.p(p,_):(g=Is(p),g.c(),g.m(m,null)):g&&(g.d(1),g=null)},d(p){p&&d(e),D.d(),g&&g.d(),V=!1,M()}}}function Wl(l){let e,t="No diary entries found. Start writing in your diary to provide context!";return{c(){e=v("div"),e.textContent=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1ja1jto"&&(e.textContent=t),this.h()},h(){u(e,"class","context-text muted svelte-a6my4i")},m(s,n){H(s,e,n)},p:Ve,d(s){s&&d(e)}}}function ql(l){let e,t,s="Recent Diary Entries:",n,r,a;return{c(){e=v("div"),t=v("strong"),t.textContent=s,n=S(),r=v("div"),a=U(l[0]),this.h()},l(i){e=h(i,"DIV",{class:!0});var c=C(e);t=h(c,"STRONG",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1tr3xsc"&&(t.textContent=s),n=I(c),r=h(c,"DIV",{class:!0});var f=C(r);a=A(f,l[0]),f.forEach(d),c.forEach(d),this.h()},h(){u(t,"class","svelte-a6my4i"),u(r,"class","context-text svelte-a6my4i"),u(e,"class","context-section svelte-a6my4i")},m(i,c){H(i,e,c),o(e,t),o(e,n),o(e,r),o(r,a)},p(i,c){c[0]&1&&Z(a,i[0])},d(i){i&&d(e)}}}function Is(l){let e,t,s="Today's Entry:",n,r,a;return{c(){e=v("div"),t=v("strong"),t.textContent=s,n=S(),r=v("div"),a=U(l[2]),this.h()},l(i){e=h(i,"DIV",{class:!0});var c=C(e);t=h(c,"STRONG",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-11d13ub"&&(t.textContent=s),n=I(c),r=h(c,"DIV",{class:!0});var f=C(r);a=A(f,l[2]),f.forEach(d),c.forEach(d),this.h()},h(){u(t,"class","svelte-a6my4i"),u(r,"class","context-text svelte-a6my4i"),u(e,"class","context-section svelte-a6my4i")},m(i,c){H(i,e,c),o(e,t),o(e,n),o(e,r),o(r,a)},p(i,c){c[0]&4&&Z(a,i[2])},d(i){i&&d(e)}}}function Ss(l){let e,t,s,n,r="üìñ Import Diary Entry",a,i,c="√ó",f,m,b,V;function M(D,g){return D[10].length>0?Gl:Yl}let y=M(l),E=y(l);return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("h3"),n.textContent=r,a=S(),i=v("button"),i.textContent=c,f=S(),m=v("div"),E.c(),this.h()},l(D){e=h(D,"DIV",{class:!0});var g=C(e);t=h(g,"DIV",{class:!0});var p=C(t);s=h(p,"DIV",{class:!0});var _=C(s);n=h(_,"H3",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-1d1ulln"&&(n.textContent=r),a=I(_),i=h(_,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-135f6p"&&(i.textContent=c),_.forEach(d),f=I(p),m=h(p,"DIV",{class:!0});var k=C(m);E.l(k),k.forEach(d),p.forEach(d),g.forEach(d),this.h()},h(){u(n,"class","svelte-a6my4i"),u(i,"class","close-import svelte-a6my4i"),u(i,"type","button"),u(s,"class","import-header svelte-a6my4i"),u(m,"class","entries-list svelte-a6my4i"),u(t,"class","import-diary-content svelte-a6my4i"),u(e,"class","import-diary-modal svelte-a6my4i")},m(D,g){H(D,e,g),o(e,t),o(t,s),o(s,n),o(s,a),o(s,i),o(t,f),o(t,m),E.m(m,null),b||(V=F(i,"click",l[18]),b=!0)},p(D,g){y===(y=M(D))&&E?E.p(D,g):(E.d(1),E=y(D),E&&(E.c(),E.m(m,null)))},d(D){D&&d(e),E.d(),b=!1,V()}}}function Yl(l){let e,t="<p>No diary entries found. Start writing in your diary first!</p>";return{c(){e=v("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1c9md4m"&&(e.innerHTML=t),this.h()},h(){u(e,"class","no-entries svelte-a6my4i")},m(s,n){H(s,e,n)},p:Ve,d(s){s&&d(e)}}}function Gl(l){let e,t="Select an entry to include in this conversation:",s,n,r=Je(l[10]),a=[];for(let i=0;i<r.length;i+=1)a[i]=Ts(ys(l,r,i));return{c(){e=v("p"),e.textContent=t,s=S(),n=v("div");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){e=h(i,"P",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-4h3q97"&&(e.textContent=t),s=I(i),n=h(i,"DIV",{class:!0});var c=C(n);for(let f=0;f<a.length;f+=1)a[f].l(c);c.forEach(d),this.h()},h(){u(e,"class","import-subtitle svelte-a6my4i"),u(n,"class","entries-grid svelte-a6my4i")},m(i,c){H(i,e,c),H(i,s,c),H(i,n,c);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(n,null)},p(i,c){if(c[0]&527360){r=Je(i[10]);let f;for(f=0;f<r.length;f+=1){const m=ys(i,r,f);a[f]?a[f].p(m,c):(a[f]=Ts(m),a[f].c(),a[f].m(n,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=r.length}},d(i){i&&(d(e),d(s),d(n)),ot(a,i)}}}function Ts(l){let e,t,s=l[54].display+"",n,r,a,i=l[54].content.substring(0,100)+"",c,f=l[54].content.length>100?"...":"",m,b,V,M;function y(){return l[37](l[54])}return{c(){e=v("button"),t=v("div"),n=U(s),r=S(),a=v("div"),c=U(i),m=U(f),b=S(),this.h()},l(E){e=h(E,"BUTTON",{class:!0,type:!0});var D=C(e);t=h(D,"DIV",{class:!0});var g=C(t);n=A(g,s),g.forEach(d),r=I(D),a=h(D,"DIV",{class:!0});var p=C(a);c=A(p,i),m=A(p,f),p.forEach(d),b=I(D),D.forEach(d),this.h()},h(){u(t,"class","entry-date svelte-a6my4i"),u(a,"class","entry-preview svelte-a6my4i"),u(e,"class","entry-option svelte-a6my4i"),u(e,"type","button"),Y(e,"selected",l[11]===l[54].date)},m(E,D){H(E,e,D),o(e,t),o(t,n),o(e,r),o(e,a),o(a,c),o(a,m),o(e,b),V||(M=F(e,"click",y),V=!0)},p(E,D){l=E,D[0]&1024&&s!==(s=l[54].display+"")&&Z(n,s),D[0]&1024&&i!==(i=l[54].content.substring(0,100)+"")&&Z(c,i),D[0]&1024&&f!==(f=l[54].content.length>100?"...":"")&&Z(m,f),D[0]&3072&&Y(e,"selected",l[11]===l[54].date)},d(E){E&&d(e),V=!1,M()}}}function Vs(l){let e,t;return e=new Al({props:{message:l[51],mode:l[7]}}),e.$on("feedback",l[38]),{c(){rt(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){lt(e,s,n),t=!0},p(s,n){const r={};n[0]&8&&(r.message=s[51]),n[0]&128&&(r.mode=s[7]),e.$set(r)},i(s){t||(Fe(e.$$.fragment,s),t=!0)},o(s){Xe(e.$$.fragment,s),t=!1},d(s){st(e,s)}}}function Ms(l){let e,t,s='<div class="typing svelte-a6my4i" aria-label="Assistant is thinking"><span class="dot svelte-a6my4i"></span> <span class="dot svelte-a6my4i"></span> <span class="dot svelte-a6my4i"></span></div>';return{c(){e=v("div"),t=v("div"),t.innerHTML=s,this.h()},l(n){e=h(n,"DIV",{class:!0});var r=C(e);t=h(r,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-lgqcl0"&&(t.innerHTML=s),r.forEach(d),this.h()},h(){u(t,"class","bubble assistant thinking svelte-a6my4i"),Y(t,"reflection-mode",l[7]==="reflection"),Y(t,"validator-mode",l[7]==="validator"),Y(t,"conflict-mode",l[7]==="conflict"),u(e,"class","bubble-container assistant svelte-a6my4i")},m(n,r){H(n,e,r),o(e,t)},p(n,r){r[0]&128&&Y(t,"reflection-mode",n[7]==="reflection"),r[0]&128&&Y(t,"validator-mode",n[7]==="validator"),r[0]&128&&Y(t,"conflict-mode",n[7]==="conflict")},d(n){n&&d(e)}}}function Xl(l){let e,t,s,n,r,a="üí¨ Chat History",i,c,f="‚ûï New Chat",m,b,V="üì• Import Diary",M,y,E,D,g,p,_,k="üí¨ Chat History",w,N,T="√ó",P,L,W,B,$,le,Q,ne,K,x,z,ce,ue,oe,be,_e,qe,Me,we,Ne,He,ee=(l[0]||l[1])&&ks(l),me=l[6]&&Cs(l);function je(R,q){return R[15].length>0?Bl:jl}let De=je(l),Ee=De(l),fe=l[8]&&Es(l),he=l[9]&&Ss(l),Le=Je(l[3]),O=[];for(let R=0;R<Le.length;R+=1)O[R]=Vs(_s(l,Le,R));const G=R=>Xe(O[R],1,1,()=>{O[R]=null});let se=l[5]&&Ms(l);function Te(R){l[39](R)}let Ce={onSelectPrompt:l[27],onCategoryChange:l[28],showLabels:!0};return l[12]!==void 0&&(Ce.selectedCategory=l[12]),x=new Jt({props:Ce}),vt.push(()=>At(x,"selectedCategory",Te)),{c(){e=v("div"),t=v("div"),s=v("div"),n=v("div"),r=v("button"),r.textContent=a,i=S(),c=v("button"),c.textContent=f,m=S(),b=v("button"),b.textContent=V,M=S(),ee&&ee.c(),y=S(),me&&me.c(),E=S(),D=v("div"),g=v("div"),p=v("div"),_=v("h3"),_.textContent=k,w=S(),N=v("button"),N.textContent=T,P=S(),L=v("div"),Ee.c(),W=S(),fe&&fe.c(),B=S(),he&&he.c(),$=S(),le=v("div");for(let R=0;R<O.length;R+=1)O[R].c();Q=S(),se&&se.c(),ne=S(),K=v("div"),rt(x.$$.fragment),ce=S(),ue=v("div"),oe=v("input"),be=S(),_e=v("button"),qe=U("Send"),this.h()},l(R){e=h(R,"DIV",{class:!0});var q=C(e);t=h(q,"DIV",{class:!0});var re=C(t);s=h(re,"DIV",{class:!0});var ie=C(s);n=h(ie,"DIV",{class:!0});var de=C(n);r=h(de,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(r)!=="svelte-orkipi"&&(r.textContent=a),i=I(de),c=h(de,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(c)!=="svelte-k661kc"&&(c.textContent=f),m=I(de),b=h(de,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(b)!=="svelte-1j9w5d"&&(b.textContent=V),M=I(de),ee&&ee.l(de),de.forEach(d),ie.forEach(d),re.forEach(d),y=I(q),me&&me.l(q),E=I(q),D=h(q,"DIV",{class:!0});var Se=C(D);g=h(Se,"DIV",{class:!0});var Be=C(g);p=h(Be,"DIV",{class:!0});var Ze=C(p);_=h(Ze,"H3",{class:!0,"data-svelte-h":!0}),J(_)!=="svelte-1wr24bl"&&(_.textContent=k),w=I(Ze),N=h(Ze,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(N)!=="svelte-a3bf64"&&(N.textContent=T),Ze.forEach(d),P=I(Be),L=h(Be,"DIV",{class:!0});var Re=C(L);Ee.l(Re),Re.forEach(d),Be.forEach(d),Se.forEach(d),W=I(q),fe&&fe.l(q),B=I(q),he&&he.l(q),$=I(q),le=h(q,"DIV",{class:!0});var Qe=C(le);for(let ke=0;ke<O.length;ke+=1)O[ke].l(Qe);Q=I(Qe),se&&se.l(Qe),Qe.forEach(d),ne=I(q),K=h(q,"DIV",{class:!0});var pe=C(K);nt(x.$$.fragment,pe),ce=I(pe),ue=h(pe,"DIV",{class:!0});var ae=C(ue);oe=h(ae,"INPUT",{type:!0,placeholder:!0,class:!0}),be=I(ae),_e=h(ae,"BUTTON",{class:!0});var Ae=C(_e);qe=A(Ae,"Send"),Ae.forEach(d),ae.forEach(d),pe.forEach(d),q.forEach(d),this.h()},h(){u(r,"class","chat-history-btn svelte-a6my4i"),u(r,"title","View previous chats"),u(c,"class","new-chat-btn svelte-a6my4i"),u(c,"title","Start a new chat"),u(b,"class","import-diary-btn svelte-a6my4i"),u(b,"title","Import diary entry to chat"),u(n,"class","header-actions svelte-a6my4i"),u(s,"class","header-row svelte-a6my4i"),u(t,"class","chat-header svelte-a6my4i"),u(_,"class","svelte-a6my4i"),u(N,"class","close-history svelte-a6my4i"),u(N,"type","button"),u(p,"class","history-header svelte-a6my4i"),u(L,"class","sessions-list svelte-a6my4i"),u(g,"class","chat-history-content svelte-a6my4i"),u(D,"class","chat-history-sidebar svelte-a6my4i"),Y(D,"open",l[14]),u(le,"class","chat-messages svelte-a6my4i"),u(oe,"type","text"),u(oe,"placeholder","Share what's on your heart... üíô"),u(oe,"class","chat-input svelte-a6my4i"),oe.disabled=l[5],_e.disabled=Me=l[5]||!l[4].trim(),u(_e,"class","send-btn svelte-a6my4i"),u(ue,"class","input-wrapper svelte-a6my4i"),u(K,"class","chat-input-container svelte-a6my4i"),u(e,"class","chat-container svelte-a6my4i"),Y(e,"sidebar-open",l[14])},m(R,q){H(R,e,q),o(e,t),o(t,s),o(s,n),o(n,r),o(n,i),o(n,c),o(n,m),o(n,b),o(n,M),ee&&ee.m(n,null),o(e,y),me&&me.m(e,null),o(e,E),o(e,D),o(D,g),o(g,p),o(p,_),o(p,w),o(p,N),o(g,P),o(g,L),Ee.m(L,null),o(e,W),fe&&fe.m(e,null),o(e,B),he&&he.m(e,null),o(e,$),o(e,le);for(let re=0;re<O.length;re+=1)O[re]&&O[re].m(le,null);o(le,Q),se&&se.m(le,null),o(e,ne),o(e,K),lt(x,K,null),o(K,ce),o(K,ue),o(ue,oe),Ye(oe,l[4]),o(ue,be),o(ue,_e),o(_e,qe),we=!0,Ne||(He=[F(r,"click",l[25]),F(c,"click",l[21]),F(b,"click",l[18]),F(N,"click",l[25]),F(oe,"input",l[40]),F(oe,"keydown",l[41]),F(_e,"click",l[29])],Ne=!0)},p(R,q){if(R[0]||R[1]?ee?ee.p(R,q):(ee=ks(R),ee.c(),ee.m(n,null)):ee&&(ee.d(1),ee=null),R[6]?me?me.p(R,q):(me=Cs(R),me.c(),me.m(e,E)):me&&(me.d(1),me=null),De===(De=je(R))&&Ee?Ee.p(R,q):(Ee.d(1),Ee=De(R),Ee&&(Ee.c(),Ee.m(L,null))),(!we||q[0]&16384)&&Y(D,"open",R[14]),R[8]?fe?fe.p(R,q):(fe=Es(R),fe.c(),fe.m(e,B)):fe&&(fe.d(1),fe=null),R[9]?he?he.p(R,q):(he=Ss(R),he.c(),he.m(e,$)):he&&(he.d(1),he=null),q[0]&67109e3){Le=Je(R[3]);let ie;for(ie=0;ie<Le.length;ie+=1){const de=_s(R,Le,ie);O[ie]?(O[ie].p(de,q),Fe(O[ie],1)):(O[ie]=Vs(de),O[ie].c(),Fe(O[ie],1),O[ie].m(le,Q))}for(Ut(),ie=Le.length;ie<O.length;ie+=1)G(ie);Ht()}R[5]?se?se.p(R,q):(se=Ms(R),se.c(),se.m(le,null)):se&&(se.d(1),se=null);const re={};!z&&q[0]&4096&&(z=!0,re.selectedCategory=R[12],Lt(()=>z=!1)),x.$set(re),(!we||q[0]&32)&&(oe.disabled=R[5]),q[0]&16&&oe.value!==R[4]&&Ye(oe,R[4]),(!we||q[0]&48&&Me!==(Me=R[5]||!R[4].trim()))&&(_e.disabled=Me),(!we||q[0]&16384)&&Y(e,"sidebar-open",R[14])},i(R){if(!we){for(let q=0;q<Le.length;q+=1)Fe(O[q]);Fe(x.$$.fragment,R),we=!0}},o(R){O=O.filter(Boolean);for(let q=0;q<O.length;q+=1)Xe(O[q]);Xe(x.$$.fragment,R),we=!1},d(R){R&&d(e),ee&&ee.d(),me&&me.d(),Ee.d(),fe&&fe.d(),he&&he.d(),ot(O,R),se&&se.d(),st(x),Ne=!1,tt(He)}}}function Ql(l){const e=new Date(l+"T00:00:00"),t=new Date;t.setHours(0,0,0,0);const s=new Date(e);s.setHours(0,0,0,0);const n=t-s,r=Math.floor(n/(1e3*60*60*24));if(r===0)return"Today";if(r===1)return"Yesterday";if(r<7)return`${r} days ago`;const a={month:"short",day:"numeric",year:e.getFullYear()!==t.getFullYear()?"numeric":void 0};return e.toLocaleDateString("en-US",a)}function Zl(l){return!l.messages||l.messages.length===0?!1:l.messages.some(e=>e.role==="user")}function Ft(){const l=new Date().getHours();return`${l<12?"Good morning":l<17?"Good afternoon":"Good evening"}! üíô This is a space for you to explore your thoughts and feelings. I'll listen and reflect with you as you process your experiences, especially when you're feeling isolated, homesick, or far from your support system. What would you like to explore today?`}function xl(l,e,t){let{diaryContext:s=""}=e,{includeTodayEntry:n=!1}=e,{todayEntry:r=""}=e,a=[],i="",c=!1,f="",m=null,b="reflection",V=!1,M=!1,y=[],E="",D="daily",g=null,p=!1,_=[],k=null,w=null;const N=new hl,T=new Et,P=new Ul;function L(){const O=T.getAllEntries(),G=Object.keys(O).filter(se=>O[se]&&O[se].trim().length>0).sort((se,Te)=>new Date(Te+"T00:00:00")-new Date(se+"T00:00:00"));t(10,y=G.map(se=>({date:se,content:O[se],display:Ql(se)})))}function W(){M||L(),t(9,M=!M)}function B(O){t(11,E=O.date),O.content;const G=T.formatDate();if(O.date===G)t(1,n=!0);else if(!s.includes(O.date)){const se=`Date: ${O.date}
${O.content}`;t(0,s=s?`${s}

---

${se}`:se)}t(9,M=!1),g&&P.updateSession(g,{diaryContext:s,includeTodayEntry:n}),le(O.date,O.content)}function $(O){const G=T.getEntry(O);if(G&&G.trim()){const se=T.formatDate();if(O===se)t(1,n=!0);else{const Te=`Date: ${O}
${G}`;t(0,s=s?`${s}

---

${Te}`:Te)}g&&P.updateSession(g,{diaryContext:s,includeTodayEntry:n}),le(O,G)}}async function le(O,G){var R,q;const se=G.substring(0,100).trim(),Ce={role:"user",content:se.length<G.length?`I wrote about this: "${se}..."`:`I wrote about this: "${se}"`,id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};t(3,a=[...a,Ce]),g&&P.setMessages(g,a),t(4,i=""),t(5,c=!0),t(6,f=""),w=new AbortController;try{let re=s;if(n&&r&&r.trim()){const Be=`Today's diary entry (${new Date().toISOString().split("T")[0]}):
${r}`;re=re?`${re}

---

${Be}`:Be}const ie=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:a,diaryContext:re}),signal:w.signal});if(w.signal.aborted)return;const de=await ie.json();if(w.signal.aborted)return;if(!ie.ok||de!=null&&de.error){t(6,f=(de==null?void 0:de.error)||"Request failed"),t(5,c=!1),w=null;return}if(de.assistantMessage){if(w.signal.aborted)return;const Se={role:"assistant",content:de.assistantMessage,id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};t(3,a=[...a,Se]),m=de.replierInput||null,(R=de.replierInput)!=null&&R.agent&&t(7,b=de.replierInput.agent),(q=de.replierInput)!=null&&q.metrics&&N.saveMetricsHistory(de.replierInput.metrics),g&&(P.setMessages(g,a),P.updateSession(g,{diaryContext:s,includeTodayEntry:n}))}}catch(re){if(re.name==="AbortError"){t(5,c=!1),w=null;return}t(6,f="Failed to send message. Please try again."),console.error("Chat error:",re)}finally{w!=null&&w.signal.aborted||(t(5,c=!1),w=null)}}function Q(){const O=P.getOrCreateCurrentSession();if(O){if(t(13,g=O.id),t(3,a=O.messages||[]),a.length===0){const G=Ft();t(3,a=[{role:"assistant",content:G,id:`msg_${Date.now()}_greeting`}]),P.setMessages(g,a)}O.diaryContext&&t(0,s=O.diaryContext),O.includeTodayEntry!==void 0&&t(1,n=O.includeTodayEntry)}ne()}function ne(){const O=P.getAllSessions();t(15,_=O.filter(G=>Zl(G)))}function K(O){const G=P.getSession(O);if(G){if(w&&c&&(w.abort(),w=null,t(5,c=!1)),g&&P.updateSession(g,{diaryContext:s,includeTodayEntry:n}),t(13,g=O),P.setCurrentSessionId(O),t(3,a=G.messages||[]),a.length===0){const se=Ft();t(3,a=[{role:"assistant",content:se,id:`msg_${Date.now()}_greeting`}]),P.setMessages(g,a)}t(0,s=G.diaryContext||""),t(1,n=G.includeTodayEntry||!1),t(14,p=!1)}}function x(){w&&c&&(w.abort(),w=null,t(5,c=!1)),g&&P.updateSession(g,{diaryContext:s,includeTodayEntry:n});const O=P.createSession();if(O){t(13,g=O.id),t(3,a=[]);const G=Ft();t(3,a=[{role:"assistant",content:G,id:`msg_${Date.now()}_greeting`}]),P.setMessages(g,a),t(0,s=""),t(1,n=!1),t(14,p=!1),ne()}}function z(O,G){G&&G.stopPropagation(),t(16,k=O)}function ce(O){O&&O.stopPropagation(),t(16,k=null)}function ue(O,G){G&&G.stopPropagation(),O===g&&w&&c&&(w.abort(),w=null,t(5,c=!1),t(6,f="Request cancelled")),P.deleteSession(O),ne(),t(16,k=null),O===g&&x()}function oe(){p||ne(),t(14,p=!p)}function be(O){if(typeof window<"u")try{const G=JSON.parse(localStorage.getItem("response_feedback")||"[]");G.push({...O,timestamp:new Date().toISOString(),sessionId:g}),localStorage.setItem("response_feedback",JSON.stringify(G))}catch(G){console.error("Error saving feedback:",G)}}mt(()=>{Q()});function _e(O){t(4,i=O)}function qe(O){t(12,D=O)}async function Me(){var se,Te;const O=i.trim();if(!O||c)return;const G={role:"user",content:O,id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};t(3,a=[...a,G]),g&&P.setMessages(g,a),t(4,i=""),t(5,c=!0),t(6,f=""),w=new AbortController;try{let Ce=s;if(n&&r&&r.trim()){const ie=`Today's diary entry (${new Date().toISOString().split("T")[0]}):
${r}`;Ce=Ce?`${Ce}

---

${ie}`:ie}const R=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:a,diaryContext:Ce}),signal:w.signal});if(w.signal.aborted)return;const q=await R.json();if(w.signal.aborted)return;if(!R.ok||q!=null&&q.error){t(6,f=(q==null?void 0:q.error)||"Request failed"),t(5,c=!1),w=null;return}if(q.assistantMessage){if(w.signal.aborted)return;const re={role:"assistant",content:q.assistantMessage,id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};t(3,a=[...a,re]),m=q.replierInput||null,(se=q.replierInput)!=null&&se.agent&&t(7,b=q.replierInput.agent),(Te=q.replierInput)!=null&&Te.metrics&&N.saveMetricsHistory(q.replierInput.metrics),g&&(P.setMessages(g,a),P.updateSession(g,{diaryContext:s,includeTodayEntry:n}))}}catch(Ce){if(Ce.name==="AbortError"){t(5,c=!1),w=null;return}t(6,f="Failed to send message. Please try again."),console.error("Chat error:",Ce)}finally{w!=null&&w.signal.aborted||(t(5,c=!1),w=null)}}const we=()=>t(8,V=!V),Ne=(O,G)=>ue(O.id,G),He=O=>ce(O),ee=(O,G)=>z(O.id,G),me=O=>k!==O.id&&K(O.id),je=()=>t(8,V=!1),De=O=>B(O),Ee=O=>be(O.detail);function fe(O){D=O,t(12,D)}function he(){i=this.value,t(4,i)}const Le=O=>O.key==="Enter"&&!O.shiftKey&&Me();return l.$$set=O=>{"diaryContext"in O&&t(0,s=O.diaryContext),"includeTodayEntry"in O&&t(1,n=O.includeTodayEntry),"todayEntry"in O&&t(2,r=O.todayEntry)},[s,n,r,a,i,c,f,b,V,M,y,E,D,g,p,_,k,P,W,B,K,x,z,ce,ue,oe,be,_e,qe,Me,$,we,Ne,He,ee,me,je,De,Ee,fe,he,Le]}class $l extends ft{constructor(e){super(),dt(this,e,xl,Xl,ut,{diaryContext:0,includeTodayEntry:1,todayEntry:2,importEntryForDate:30},null,[-1,-1])}get importEntryForDate(){return this.$$.ctx[30]}}function Ns(l,e,t){const s=l.slice();return s[20]=e[t],s}function Ps(l){let e,t,s,n,r="How are you feeling today? üíô",a,i,c="√ó",f,m,b,V="Select your mood:",M,y,E,D,g,p=Je(l[6]),_=[];for(let w=0;w<p.length;w+=1)_[w]=Os(Ns(l,p,w));let k=l[1]&&Ls(l);return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("h2"),n.textContent=r,a=S(),i=v("button"),i.textContent=c,f=S(),m=v("div"),b=v("p"),b.textContent=V,M=S(),y=v("div");for(let w=0;w<_.length;w+=1)_[w].c();E=S(),k&&k.c(),this.h()},l(w){e=h(w,"DIV",{class:!0});var N=C(e);t=h(N,"DIV",{class:!0});var T=C(t);s=h(T,"DIV",{class:!0});var P=C(s);n=h(P,"H2",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-ppp36n"&&(n.textContent=r),a=I(P),i=h(P,"BUTTON",{class:!0,"data-svelte-h":!0}),J(i)!=="svelte-18n6hwd"&&(i.textContent=c),P.forEach(d),f=I(T),m=h(T,"DIV",{class:!0});var L=C(m);b=h(L,"P",{class:!0,"data-svelte-h":!0}),J(b)!=="svelte-b6kub9"&&(b.textContent=V),M=I(L),y=h(L,"DIV",{class:!0});var W=C(y);for(let B=0;B<_.length;B+=1)_[B].l(W);W.forEach(d),L.forEach(d),E=I(T),k&&k.l(T),T.forEach(d),N.forEach(d),this.h()},h(){u(n,"class","svelte-n6b7h7"),u(i,"class","close-btn svelte-n6b7h7"),u(s,"class","mood-header svelte-n6b7h7"),u(b,"class","mood-prompt svelte-n6b7h7"),u(y,"class","mood-grid svelte-n6b7h7"),u(m,"class","mood-selector"),u(t,"class","mood-tracker-card svelte-n6b7h7"),u(e,"class","mood-tracker-overlay svelte-n6b7h7")},m(w,N){H(w,e,N),o(e,t),o(t,s),o(s,n),o(s,a),o(s,i),o(t,f),o(t,m),o(m,b),o(m,M),o(m,y);for(let T=0;T<_.length;T+=1)_[T]&&_[T].m(y,null);o(t,E),k&&k.m(t,null),D||(g=F(i,"click",l[8]),D=!0)},p(w,N){if(N&66){p=Je(w[6]);let T;for(T=0;T<p.length;T+=1){const P=Ns(w,p,T);_[T]?_[T].p(P,N):(_[T]=Os(P),_[T].c(),_[T].m(y,null))}for(;T<_.length;T+=1)_[T].d(1);_.length=p.length}w[1]?k?k.p(w,N):(k=Ls(w),k.c(),k.m(t,null)):k&&(k.d(1),k=null)},d(w){w&&d(e),ot(_,w),k&&k.d(),D=!1,g()}}}function Os(l){let e,t,s=l[20].emoji+"",n,r,a,i=l[20].label+"",c,f,m,b;function V(){return l[11](l[20])}return{c(){e=v("button"),t=v("span"),n=U(s),r=S(),a=v("span"),c=U(i),f=S(),this.h()},l(M){e=h(M,"BUTTON",{class:!0});var y=C(e);t=h(y,"SPAN",{class:!0});var E=C(t);n=A(E,s),E.forEach(d),r=I(y),a=h(y,"SPAN",{class:!0});var D=C(a);c=A(D,i),D.forEach(d),f=I(y),y.forEach(d),this.h()},h(){u(t,"class","mood-emoji svelte-n6b7h7"),u(a,"class","mood-label svelte-n6b7h7"),u(e,"class","mood-btn svelte-n6b7h7"),Y(e,"selected",l[1]===l[20].value)},m(M,y){H(M,e,y),o(e,t),o(t,n),o(e,r),o(e,a),o(a,c),o(e,f),m||(b=F(e,"click",V),m=!0)},p(M,y){l=M,y&66&&Y(e,"selected",l[1]===l[20].value)},d(M){M&&d(e),m=!1,b()}}}function Ls(l){let e,t,s,n,r,a,i,c,f,m="üìÖ Daily",b,V,M="Changes day-to-day based on immediate pressures",y,E,D,g,p,_,k,w,N,T,P,L="üìÜ Long-term",W,B,$="Longer-term feeling that changes over weeks",le,Q,ne,K,x,z,ce,ue,oe,be,_e,qe="üìÜ Long-term",Me,we,Ne="Longer-term feeling that changes over weeks",He,ee,me,je,De,Ee="Quick notes (optional):",fe,he,Le,O,G,se="Save & Continue",Te,Ce,R="Skip for now",q,re,ie,de,Se,Be,Ze="Don't show this daily reminder",Re,Qe;return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("label"),r=U("Stress Level: "),a=U(l[2]),i=U("/10"),c=S(),f=v("span"),f.textContent=m,b=S(),V=v("div"),V.textContent=M,y=S(),E=v("input"),D=S(),g=v("div"),p=v("div"),_=v("label"),k=U("Loneliness: "),w=U(l[3]),N=U("/10"),T=S(),P=v("span"),P.textContent=L,W=S(),B=v("div"),B.textContent=$,le=S(),Q=v("input"),ne=S(),K=v("div"),x=v("div"),z=v("label"),ce=U("Homesickness: "),ue=U(l[4]),oe=U("/10"),be=S(),_e=v("span"),_e.textContent=qe,Me=S(),we=v("div"),we.textContent=Ne,He=S(),ee=v("input"),me=S(),je=v("div"),De=v("label"),De.textContent=Ee,fe=S(),he=v("textarea"),Le=S(),O=v("div"),G=v("button"),G.textContent=se,Te=S(),Ce=v("button"),Ce.textContent=R,q=S(),re=v("div"),ie=v("label"),de=v("input"),Se=S(),Be=v("span"),Be.textContent=Ze,this.h()},l(pe){e=h(pe,"DIV",{class:!0});var ae=C(e);t=h(ae,"DIV",{class:!0});var Ae=C(t);s=h(Ae,"DIV",{class:!0});var ke=C(s);n=h(ke,"LABEL",{class:!0});var ge=C(n);r=A(ge,"Stress Level: "),a=A(ge,l[2]),i=A(ge,"/10"),ge.forEach(d),c=I(ke),f=h(ke,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),J(f)!=="svelte-1e39tsl"&&(f.textContent=m),ke.forEach(d),b=I(Ae),V=h(Ae,"DIV",{class:!0,"data-svelte-h":!0}),J(V)!=="svelte-18ofzjc"&&(V.textContent=M),y=I(Ae),E=h(Ae,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Ae.forEach(d),D=I(ae),g=h(ae,"DIV",{class:!0});var ye=C(g);p=h(ye,"DIV",{class:!0});var j=C(p);_=h(j,"LABEL",{class:!0});var X=C(_);k=A(X,"Loneliness: "),w=A(X,l[3]),N=A(X,"/10"),X.forEach(d),T=I(j),P=h(j,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),J(P)!=="svelte-19m62yt"&&(P.textContent=L),j.forEach(d),W=I(ye),B=h(ye,"DIV",{class:!0,"data-svelte-h":!0}),J(B)!=="svelte-1kblyqs"&&(B.textContent=$),le=I(ye),Q=h(ye,"INPUT",{type:!0,min:!0,max:!0,class:!0}),ye.forEach(d),ne=I(ae),K=h(ae,"DIV",{class:!0});var Ie=C(K);x=h(Ie,"DIV",{class:!0});var ze=C(x);z=h(ze,"LABEL",{class:!0});var Pe=C(z);ce=A(Pe,"Homesickness: "),ue=A(Pe,l[4]),oe=A(Pe,"/10"),Pe.forEach(d),be=I(ze),_e=h(ze,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),J(_e)!=="svelte-19m62yt"&&(_e.textContent=qe),ze.forEach(d),Me=I(Ie),we=h(Ie,"DIV",{class:!0,"data-svelte-h":!0}),J(we)!=="svelte-1kblyqs"&&(we.textContent=Ne),He=I(Ie),ee=h(Ie,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Ie.forEach(d),ae.forEach(d),me=I(pe),je=h(pe,"DIV",{class:!0});var $e=C(je);De=h($e,"LABEL",{class:!0,"data-svelte-h":!0}),J(De)!=="svelte-w5c58p"&&(De.textContent=Ee),fe=I($e),he=h($e,"TEXTAREA",{placeholder:!0,class:!0}),C(he).forEach(d),$e.forEach(d),Le=I(pe),O=h(pe,"DIV",{class:!0});var it=C(O);G=h(it,"BUTTON",{class:!0,"data-svelte-h":!0}),J(G)!=="svelte-gjst35"&&(G.textContent=se),Te=I(it),Ce=h(it,"BUTTON",{class:!0,"data-svelte-h":!0}),J(Ce)!=="svelte-10ctwmv"&&(Ce.textContent=R),it.forEach(d),q=I(pe),re=h(pe,"DIV",{class:!0});var We=C(re);ie=h(We,"LABEL",{class:!0});var Oe=C(ie);de=h(Oe,"INPUT",{type:!0,class:!0}),Se=I(Oe),Be=h(Oe,"SPAN",{"data-svelte-h":!0}),J(Be)!=="svelte-5qf5s4"&&(Be.textContent=Ze),Oe.forEach(d),We.forEach(d),this.h()},h(){u(n,"class","svelte-n6b7h7"),u(f,"class","tracker-hint svelte-n6b7h7"),u(f,"title","Daily stress - changes day to day based on immediate pressures, deadlines, or daily challenges"),u(s,"class","tracker-header svelte-n6b7h7"),u(V,"class","tracker-explanation svelte-n6b7h7"),u(E,"type","range"),u(E,"min","1"),u(E,"max","10"),u(E,"class","slider svelte-n6b7h7"),u(t,"class","level-tracker svelte-n6b7h7"),u(_,"class","svelte-n6b7h7"),u(P,"class","tracker-hint svelte-n6b7h7"),u(P,"title","Longer-term feeling - may change over weeks or months, not daily"),u(p,"class","tracker-header svelte-n6b7h7"),u(B,"class","tracker-explanation svelte-n6b7h7"),u(Q,"type","range"),u(Q,"min","1"),u(Q,"max","10"),u(Q,"class","slider svelte-n6b7h7"),u(g,"class","level-tracker svelte-n6b7h7"),u(z,"class","svelte-n6b7h7"),u(_e,"class","tracker-hint svelte-n6b7h7"),u(_e,"title","Longer-term feeling - may change over weeks or months, not daily"),u(x,"class","tracker-header svelte-n6b7h7"),u(we,"class","tracker-explanation svelte-n6b7h7"),u(ee,"type","range"),u(ee,"min","1"),u(ee,"max","10"),u(ee,"class","slider svelte-n6b7h7"),u(K,"class","level-tracker svelte-n6b7h7"),u(e,"class","level-trackers svelte-n6b7h7"),u(De,"class","svelte-n6b7h7"),u(he,"placeholder","What's on your mind today?"),u(he,"class","notes-input svelte-n6b7h7"),u(je,"class","quick-notes svelte-n6b7h7"),u(G,"class","save-btn svelte-n6b7h7"),u(Ce,"class","skip-btn svelte-n6b7h7"),u(O,"class","mood-actions svelte-n6b7h7"),u(de,"type","checkbox"),u(de,"class","svelte-n6b7h7"),u(ie,"class","disable-checkbox svelte-n6b7h7"),u(re,"class","mood-footer svelte-n6b7h7")},m(pe,ae){H(pe,e,ae),o(e,t),o(t,s),o(s,n),o(n,r),o(n,a),o(n,i),o(s,c),o(s,f),o(t,b),o(t,V),o(t,y),o(t,E),Ye(E,l[2]),o(e,D),o(e,g),o(g,p),o(p,_),o(_,k),o(_,w),o(_,N),o(p,T),o(p,P),o(g,W),o(g,B),o(g,le),o(g,Q),Ye(Q,l[3]),o(e,ne),o(e,K),o(K,x),o(x,z),o(z,ce),o(z,ue),o(z,oe),o(x,be),o(x,_e),o(K,Me),o(K,we),o(K,He),o(K,ee),Ye(ee,l[4]),H(pe,me,ae),H(pe,je,ae),o(je,De),o(je,fe),o(je,he),Ye(he,l[5]),H(pe,Le,ae),H(pe,O,ae),o(O,G),o(O,Te),o(O,Ce),H(pe,q,ae),H(pe,re,ae),o(re,ie),o(ie,de),o(ie,Se),o(ie,Be),Re||(Qe=[F(E,"change",l[12]),F(E,"input",l[12]),F(Q,"change",l[13]),F(Q,"input",l[13]),F(ee,"change",l[14]),F(ee,"input",l[14]),F(he,"input",l[15]),F(G,"click",l[7]),F(Ce,"click",l[8]),F(de,"change",l[16])],Re=!0)},p(pe,ae){ae&4&&Z(a,pe[2]),ae&4&&Ye(E,pe[2]),ae&8&&Z(w,pe[3]),ae&8&&Ye(Q,pe[3]),ae&16&&Z(ue,pe[4]),ae&16&&Ye(ee,pe[4]),ae&32&&Ye(he,pe[5])},d(pe){pe&&(d(e),d(me),d(je),d(Le),d(O),d(q),d(re)),Re=!1,tt(Qe)}}}function en(l){let e,t=l[0]&&Ps(l);return{c(){t&&t.c(),e=at()},l(s){t&&t.l(s),e=at()},m(s,n){t&&t.m(s,n),H(s,e,n)},p(s,[n]){s[0]?t?t.p(s,n):(t=Ps(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ve,o:Ve,d(s){s&&d(e),t&&t.d(s)}}}function tn(l,e,t){const s=new Et;let n=!1,r=null,a=5,i=5,c=5,f="";const m=[{emoji:"üòä",label:"Happy",value:"happy"},{emoji:"üòå",label:"Calm",value:"calm"},{emoji:"üò¢",label:"Sad",value:"sad"},{emoji:"üò∞",label:"Anxious",value:"anxious"},{emoji:"üòî",label:"Lonely",value:"lonely"},{emoji:"üò¥",label:"Tired",value:"tired"},{emoji:"üò§",label:"Frustrated",value:"frustrated"},{emoji:"‚ù§Ô∏è",label:"Loved",value:"loved"}];mt(()=>{b(),V()});function b(){if(typeof window>"u")return;const T=s.formatDate();try{const P=localStorage.getItem(`mood_${T}`);if(P){const L=JSON.parse(P);t(1,r=L.mood),t(2,a=L.stressLevel||5),t(3,i=L.lonelinessLevel||5),t(4,c=L.homesicknessLevel||5),t(5,f=L.notes||"")}}catch(P){console.error("Error loading mood:",P)}}function V(){const T=s.formatDate(),P=localStorage.getItem("last_mood_check");localStorage.getItem("mood_tracker_preference")!=="disabled"&&P!==T&&t(0,n=!0)}function M(){if(!r)return;const T=s.formatDate(),P={mood:r,stressLevel:a,lonelinessLevel:i,homesicknessLevel:c,notes:f,timestamp:new Date().toISOString()};try{localStorage.setItem(`mood_${T}`,JSON.stringify(P)),localStorage.setItem("last_mood_check",T),s.setMood(T,r),t(0,n=!1),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("moodSaved",{detail:{date:T,mood:r}}))}catch(L){console.error("Error saving mood:",L)}}function y(){const T=s.formatDate();localStorage.setItem("last_mood_check",T),t(0,n=!1)}function E(){t(0,n=!n)}let{showMoodTrackerProp:D=!1}=e;const g=T=>t(1,r=T.value);function p(){a=zt(this.value),t(2,a)}function _(){i=zt(this.value),t(3,i)}function k(){c=zt(this.value),t(4,c)}function w(){f=this.value,t(5,f)}const N=T=>{T.target.checked?localStorage.setItem("mood_tracker_preference","disabled"):localStorage.removeItem("mood_tracker_preference")};return l.$$set=T=>{"showMoodTrackerProp"in T&&t(10,D=T.showMoodTrackerProp)},l.$$.update=()=>{l.$$.dirty&1024&&D!==void 0&&t(0,n=D)},[n,r,a,i,c,f,m,M,y,E,D,g,p,_,k,w,N]}class sn extends ft{constructor(e){super(),dt(this,e,tn,en,ut,{toggleMoodTracker:9,showMoodTrackerProp:10})}get toggleMoodTracker(){return this.$$.ctx[9]}}function As(l){let e,t,s,n="Your Emotional Journey üíô",r,a,i="üîÑ",c,f,m,b,V="Average Stress (7 days)",M,y,E=l[0].avgStress+"",D,g,p,_,k,w,N,T,P="Average Loneliness (7 days)",L,W,B=l[0].avgLoneliness+"",$,le,Q,ne,K,x,z,ce,ue="Sentiment Trend",oe,be,_e=Hs(l[0].sentimentTrend)+"",qe,Me,we=l[0].sentimentTrend+"",Ne,He,ee,me,je="Connection Reminders",De,Ee,fe=l[0].connectionEncouragements+"",he,Le,O,G,se,Te,Ce,R,q,re=l[0].totalInteractions+"",ie,de,Se=l[0].totalInteractions!==1?"s":"",Be,Ze,Re,Qe;function pe(ge,ye){return ge[0].connectionEncouragements>0?nn:ln}let ae=pe(l),Ae=ae(l),ke=l[0].feedbackStats&&l[0].feedbackStats.total>0&&Us(l);return{c(){e=v("div"),t=v("div"),s=v("h3"),s.textContent=n,r=S(),a=v("button"),a.textContent=i,c=S(),f=v("div"),m=v("div"),b=v("div"),b.textContent=V,M=S(),y=v("div"),D=U(E),g=U("/10"),p=S(),_=v("div"),k=v("div"),w=S(),N=v("div"),T=v("div"),T.textContent=P,L=S(),W=v("div"),$=U(B),le=U("/10"),Q=S(),ne=v("div"),K=v("div"),x=S(),z=v("div"),ce=v("div"),ce.textContent=ue,oe=S(),be=v("div"),qe=U(_e),Me=S(),Ne=U(we),He=S(),ee=v("div"),me=v("div"),me.textContent=je,De=S(),Ee=v("div"),he=U(fe),Le=U(" times this week"),O=S(),G=v("div"),Ae.c(),se=S(),ke&&ke.c(),Te=S(),Ce=v("div"),R=v("p"),q=U("üí¨ You've had "),ie=U(re),de=U(" conversation"),Be=U(Se),Ze=U(` this week. \r
        Keep taking care of yourself!`),this.h()},l(ge){e=h(ge,"DIV",{class:!0});var ye=C(e);t=h(ye,"DIV",{class:!0});var j=C(t);s=h(j,"H3",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-qfu6pj"&&(s.textContent=n),r=I(j),a=h(j,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(a)!=="svelte-4o4vpe"&&(a.textContent=i),j.forEach(d),c=I(ye),f=h(ye,"DIV",{class:!0});var X=C(f);m=h(X,"DIV",{class:!0});var Ie=C(m);b=h(Ie,"DIV",{class:!0,"data-svelte-h":!0}),J(b)!=="svelte-hmscjq"&&(b.textContent=V),M=I(Ie),y=h(Ie,"DIV",{class:!0,style:!0});var ze=C(y);D=A(ze,E),g=A(ze,"/10"),ze.forEach(d),p=I(Ie),_=h(Ie,"DIV",{class:!0});var Pe=C(_);k=h(Pe,"DIV",{class:!0,style:!0}),C(k).forEach(d),Pe.forEach(d),Ie.forEach(d),w=I(X),N=h(X,"DIV",{class:!0});var $e=C(N);T=h($e,"DIV",{class:!0,"data-svelte-h":!0}),J(T)!=="svelte-rmvzm6"&&(T.textContent=P),L=I($e),W=h($e,"DIV",{class:!0,style:!0});var it=C(W);$=A(it,B),le=A(it,"/10"),it.forEach(d),Q=I($e),ne=h($e,"DIV",{class:!0});var We=C(ne);K=h(We,"DIV",{class:!0,style:!0}),C(K).forEach(d),We.forEach(d),$e.forEach(d),x=I(X),z=h(X,"DIV",{class:!0});var Oe=C(z);ce=h(Oe,"DIV",{class:!0,"data-svelte-h":!0}),J(ce)!=="svelte-1pmn22g"&&(ce.textContent=ue),oe=I(Oe),be=h(Oe,"DIV",{class:!0,style:!0});var bt=C(be);qe=A(bt,_e),Me=I(bt),Ne=A(bt,we),bt.forEach(d),Oe.forEach(d),He=I(X),ee=h(X,"DIV",{class:!0});var ht=C(ee);me=h(ht,"DIV",{class:!0,"data-svelte-h":!0}),J(me)!=="svelte-1p0f58l"&&(me.textContent=je),De=I(ht),Ee=h(ht,"DIV",{class:!0});var Ge=C(Ee);he=A(Ge,fe),Le=A(Ge," times this week"),Ge.forEach(d),O=I(ht),G=h(ht,"DIV",{class:!0});var Tt=C(G);Ae.l(Tt),Tt.forEach(d),ht.forEach(d),se=I(X),ke&&ke.l(X),X.forEach(d),Te=I(ye),Ce=h(ye,"DIV",{class:!0});var It=C(Ce);R=h(It,"P",{class:!0});var Ke=C(R);q=A(Ke,"üí¨ You've had "),ie=A(Ke,re),de=A(Ke," conversation"),Be=A(Ke,Se),Ze=A(Ke,` this week. \r
        Keep taking care of yourself!`),Ke.forEach(d),It.forEach(d),ye.forEach(d),this.h()},h(){u(s,"class","svelte-x90ihm"),u(a,"class","refresh-btn svelte-x90ihm"),u(a,"title","Refresh"),u(t,"class","insights-header svelte-x90ihm"),u(b,"class","insight-label svelte-x90ihm"),u(y,"class","insight-value svelte-x90ihm"),Ue(y,"color",gt(l[0].avgStress)),u(k,"class","insight-bar-fill svelte-x90ihm"),Ue(k,"width",l[0].avgStress*10+"%"),Ue(k,"background",gt(l[0].avgStress)),u(_,"class","insight-bar svelte-x90ihm"),u(m,"class","insight-item svelte-x90ihm"),u(T,"class","insight-label svelte-x90ihm"),u(W,"class","insight-value svelte-x90ihm"),Ue(W,"color",gt(l[0].avgLoneliness)),u(K,"class","insight-bar-fill svelte-x90ihm"),Ue(K,"width",l[0].avgLoneliness*10+"%"),Ue(K,"background",gt(l[0].avgLoneliness)),u(ne,"class","insight-bar svelte-x90ihm"),u(N,"class","insight-item svelte-x90ihm"),u(ce,"class","insight-label svelte-x90ihm"),u(be,"class","insight-value svelte-x90ihm"),Ue(be,"color",js(l[0].sentimentTrend)),u(z,"class","insight-item svelte-x90ihm"),u(me,"class","insight-label svelte-x90ihm"),u(Ee,"class","insight-value svelte-x90ihm"),u(G,"class","insight-note svelte-x90ihm"),u(ee,"class","insight-item svelte-x90ihm"),u(f,"class","insights-grid svelte-x90ihm"),u(R,"class","support-message svelte-x90ihm"),u(Ce,"class","insights-footer svelte-x90ihm"),u(e,"class","insights-card svelte-x90ihm")},m(ge,ye){H(ge,e,ye),o(e,t),o(t,s),o(t,r),o(t,a),o(e,c),o(e,f),o(f,m),o(m,b),o(m,M),o(m,y),o(y,D),o(y,g),o(m,p),o(m,_),o(_,k),o(f,w),o(f,N),o(N,T),o(N,L),o(N,W),o(W,$),o(W,le),o(N,Q),o(N,ne),o(ne,K),o(f,x),o(f,z),o(z,ce),o(z,oe),o(z,be),o(be,qe),o(be,Me),o(be,Ne),o(f,He),o(f,ee),o(ee,me),o(ee,De),o(ee,Ee),o(Ee,he),o(Ee,Le),o(ee,O),o(ee,G),Ae.m(G,null),o(f,se),ke&&ke.m(f,null),o(e,Te),o(e,Ce),o(Ce,R),o(R,q),o(R,ie),o(R,de),o(R,Be),o(R,Ze),Re||(Qe=F(a,"click",l[1]),Re=!0)},p(ge,ye){ye&1&&E!==(E=ge[0].avgStress+"")&&Z(D,E),ye&1&&Ue(y,"color",gt(ge[0].avgStress)),ye&1&&Ue(k,"width",ge[0].avgStress*10+"%"),ye&1&&Ue(k,"background",gt(ge[0].avgStress)),ye&1&&B!==(B=ge[0].avgLoneliness+"")&&Z($,B),ye&1&&Ue(W,"color",gt(ge[0].avgLoneliness)),ye&1&&Ue(K,"width",ge[0].avgLoneliness*10+"%"),ye&1&&Ue(K,"background",gt(ge[0].avgLoneliness)),ye&1&&_e!==(_e=Hs(ge[0].sentimentTrend)+"")&&Z(qe,_e),ye&1&&we!==(we=ge[0].sentimentTrend+"")&&Z(Ne,we),ye&1&&Ue(be,"color",js(ge[0].sentimentTrend)),ye&1&&fe!==(fe=ge[0].connectionEncouragements+"")&&Z(he,fe),ae!==(ae=pe(ge))&&(Ae.d(1),Ae=ae(ge),Ae&&(Ae.c(),Ae.m(G,null))),ge[0].feedbackStats&&ge[0].feedbackStats.total>0?ke?ke.p(ge,ye):(ke=Us(ge),ke.c(),ke.m(f,null)):ke&&(ke.d(1),ke=null),ye&1&&re!==(re=ge[0].totalInteractions+"")&&Z(ie,re),ye&1&&Se!==(Se=ge[0].totalInteractions!==1?"s":"")&&Z(Be,Se)},d(ge){ge&&d(e),Ae.d(),ke&&ke.d(),Re=!1,Qe()}}}function ln(l){let e;return{c(){e=U("Remember: reaching out to loved ones can help when you're feeling isolated.")},l(t){e=A(t,"Remember: reaching out to loved ones can help when you're feeling isolated.")},m(t,s){H(t,e,s)},d(t){t&&d(e)}}}function nn(l){let e;return{c(){e=U("Great job! Keep reaching out to friends and family.")},l(t){e=A(t,"Great job! Keep reaching out to friends and family.")},m(t,s){H(t,e,s)},d(t){t&&d(e)}}}function Us(l){let e,t,s="Response Helpfulness",n,r,a=l[0].feedbackStats.helpfulRate+"",i,c,f,m,b=l[0].feedbackStats.helpful+"",V,M,y=l[0].feedbackStats.notHelpful+"",E,D;return{c(){e=v("div"),t=v("div"),t.textContent=s,n=S(),r=v("div"),i=U(a),c=U("% helpful"),f=S(),m=v("div"),V=U(b),M=U(" helpful, "),E=U(y),D=U(" not helpful"),this.h()},l(g){e=h(g,"DIV",{class:!0});var p=C(e);t=h(p,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-18jusq"&&(t.textContent=s),n=I(p),r=h(p,"DIV",{class:!0,style:!0});var _=C(r);i=A(_,a),c=A(_,"% helpful"),_.forEach(d),f=I(p),m=h(p,"DIV",{class:!0});var k=C(m);V=A(k,b),M=A(k," helpful, "),E=A(k,y),D=A(k," not helpful"),k.forEach(d),p.forEach(d),this.h()},h(){u(t,"class","insight-label svelte-x90ihm"),u(r,"class","insight-value svelte-x90ihm"),Ue(r,"color",l[0].feedbackStats.helpfulRate>=70?"#22c55e":l[0].feedbackStats.helpfulRate>=50?"#eab308":"#ef4444"),u(m,"class","insight-note svelte-x90ihm"),u(e,"class","insight-item svelte-x90ihm")},m(g,p){H(g,e,p),o(e,t),o(e,n),o(e,r),o(r,i),o(r,c),o(e,f),o(e,m),o(m,V),o(m,M),o(m,E),o(m,D)},p(g,p){p&1&&a!==(a=g[0].feedbackStats.helpfulRate+"")&&Z(i,a),p&1&&Ue(r,"color",g[0].feedbackStats.helpfulRate>=70?"#22c55e":g[0].feedbackStats.helpfulRate>=50?"#eab308":"#ef4444"),p&1&&b!==(b=g[0].feedbackStats.helpful+"")&&Z(V,b),p&1&&y!==(y=g[0].feedbackStats.notHelpful+"")&&Z(E,y)},d(g){g&&d(e)}}}function rn(l){let e,t=l[0]&&As(l);return{c(){t&&t.c(),e=at()},l(s){t&&t.l(s),e=at()},m(s,n){t&&t.m(s,n),H(s,e,n)},p(s,[n]){s[0]?t?t.p(s,n):(t=As(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ve,o:Ve,d(s){s&&d(e),t&&t.d(s)}}}function Hs(l){return l==="improving"?"üìà":l==="declining"?"üìâ":"‚û°Ô∏è"}function js(l){return l==="improving"?"#22c55e":l==="declining"?"#ef4444":"#6b7280"}function gt(l){return l<=3?"#22c55e":l<=5?"#eab308":l<=7?"#f97316":"#ef4444"}function an(l,e,t){let s=null;const n=new hl;mt(()=>{r()});function r(){if(t(0,s=n.getEmotionalInsights()),typeof window<"u")try{const i=JSON.parse(localStorage.getItem("response_feedback")||"[]"),c=i.filter(b=>b.helpful===!0).length,f=i.filter(b=>b.helpful===!1).length,m=c+f;t(0,s.feedbackStats={helpful:c,notHelpful:f,total:m,helpfulRate:m>0?Math.round(c/m*100):0},s)}catch(i){console.error("Error loading feedback stats:",i)}}function a(){r()}return[s,r,a]}class on extends ft{constructor(e){super(),dt(this,e,an,rn,ut,{refresh:2})}get refresh(){return this.$$.ctx[2]}}function Bs(l,e,t){const s=l.slice();return s[20]=e[t],s}function Rs(l,e,t){const s=l.slice();return s[23]=e[t],s}function zs(l){let e,t,s,n,r,a,i,c,f,m="Save",b,V,M="Cancel",y,E,D=Je(l[5]),g=[];for(let p=0;p<D.length;p+=1)g[p]=Fs(Rs(l,D,p));return{c(){e=v("div"),t=v("input"),s=S(),n=v("select");for(let p=0;p<g.length;p+=1)g[p].c();r=S(),a=v("input"),i=S(),c=v("div"),f=v("button"),f.textContent=m,b=S(),V=v("button"),V.textContent=M,this.h()},l(p){e=h(p,"DIV",{class:!0});var _=C(e);t=h(_,"INPUT",{type:!0,placeholder:!0,class:!0}),s=I(_),n=h(_,"SELECT",{class:!0});var k=C(n);for(let N=0;N<g.length;N+=1)g[N].l(k);k.forEach(d),r=I(_),a=h(_,"INPUT",{type:!0,placeholder:!0,class:!0}),i=I(_),c=h(_,"DIV",{class:!0});var w=C(c);f=h(w,"BUTTON",{class:!0,"data-svelte-h":!0}),J(f)!=="svelte-ybjj5t"&&(f.textContent=m),b=I(w),V=h(w,"BUTTON",{class:!0,"data-svelte-h":!0}),J(V)!=="svelte-1fvmfmy"&&(V.textContent=M),w.forEach(d),_.forEach(d),this.h()},h(){u(t,"type","text"),u(t,"placeholder","Name"),u(t,"class","reminder-input svelte-ldczv4"),u(n,"class","reminder-select svelte-ldczv4"),l[3]===void 0&&pl(()=>l[11].call(n)),u(a,"type","date"),u(a,"placeholder","Last contact date (optional)"),u(a,"class","reminder-input svelte-ldczv4"),u(f,"class","save-btn svelte-ldczv4"),u(V,"class","cancel-btn svelte-ldczv4"),u(c,"class","form-actions svelte-ldczv4"),u(e,"class","add-reminder-form svelte-ldczv4")},m(p,_){H(p,e,_),o(e,t),Ye(t,l[2]),o(e,s),o(e,n);for(let k=0;k<g.length;k+=1)g[k]&&g[k].m(n,null);es(n,l[3],!0),o(e,r),o(e,a),Ye(a,l[4]),o(e,i),o(e,c),o(c,f),o(c,b),o(c,V),y||(E=[F(t,"input",l[10]),F(n,"change",l[11]),F(a,"input",l[12]),F(f,"click",l[7]),F(V,"click",l[13])],y=!0)},p(p,_){if(_&4&&t.value!==p[2]&&Ye(t,p[2]),_&32){D=Je(p[5]);let k;for(k=0;k<D.length;k+=1){const w=Rs(p,D,k);g[k]?g[k].p(w,_):(g[k]=Fs(w),g[k].c(),g[k].m(n,null))}for(;k<g.length;k+=1)g[k].d(1);g.length=D.length}_&40&&es(n,p[3]),_&16&&Ye(a,p[4])},d(p){p&&d(e),ot(g,p),y=!1,tt(E)}}}function Fs(l){let e,t=l[23].emoji+"",s,n,r=l[23].label+"",a;return{c(){e=v("option"),s=U(t),n=S(),a=U(r),this.h()},l(i){e=h(i,"OPTION",{});var c=C(e);s=A(c,t),n=I(c),a=A(c,r),c.forEach(d),this.h()},h(){e.__value=l[23].value,Ye(e,e.__value)},m(i,c){H(i,e,c),o(e,s),o(e,n),o(e,a)},p:Ve,d(i){i&&d(e)}}}function cn(l){let e,t=l[20].daysSince+"",s,n;return{c(){e=U("Over "),s=U(t),n=U(" days ago - time to reach out!")},l(r){e=A(r,"Over "),s=A(r,t),n=A(r," days ago - time to reach out!")},m(r,a){H(r,e,a),H(r,s,a),H(r,n,a)},p(r,a){a&1&&t!==(t=r[20].daysSince+"")&&Z(s,t)},d(r){r&&(d(e),d(s),d(n))}}}function un(l){let e=l[20].daysSince+"",t,s,n=l[20].daysSince!==1?"s":"",r,a;return{c(){t=U(e),s=U(" day"),r=U(n),a=U(" ago")},l(i){t=A(i,e),s=A(i," day"),r=A(i,n),a=A(i," ago")},m(i,c){H(i,t,c),H(i,s,c),H(i,r,c),H(i,a,c)},p(i,c){c&1&&e!==(e=i[20].daysSince+"")&&Z(t,e),c&1&&n!==(n=i[20].daysSince!==1?"s":"")&&Z(r,n)},d(i){i&&(d(t),d(s),d(r),d(a))}}}function fn(l){let e;return{c(){e=U("Contacted today! ‚ú®")},l(t){e=A(t,"Contacted today! ‚ú®")},m(t,s){H(t,e,s)},p:Ve,d(t){t&&d(e)}}}function Js(l){let e,t,s,n=l[20].emoji+"",r,a,i,c,f=l[20].name+"",m,b,V,M,y,E,D="‚úì",g,p,_="√ó",k,w;function N(B,$){return B[20].daysSince===0?fn:B[20].daysSince<=7?un:cn}let T=N(l),P=T(l);function L(){return l[14](l[20])}function W(){return l[15](l[20])}return{c(){e=v("div"),t=v("div"),s=v("span"),r=U(n),a=S(),i=v("div"),c=v("div"),m=U(f),b=S(),V=v("div"),P.c(),M=S(),y=v("div"),E=v("button"),E.textContent=D,g=S(),p=v("button"),p.textContent=_,this.h()},l(B){e=h(B,"DIV",{class:!0});var $=C(e);t=h($,"DIV",{class:!0});var le=C(t);s=h(le,"SPAN",{class:!0});var Q=C(s);r=A(Q,n),Q.forEach(d),a=I(le),i=h(le,"DIV",{class:!0});var ne=C(i);c=h(ne,"DIV",{class:!0});var K=C(c);m=A(K,f),K.forEach(d),b=I(ne),V=h(ne,"DIV",{class:!0,style:!0});var x=C(V);P.l(x),x.forEach(d),ne.forEach(d),le.forEach(d),M=I($),y=h($,"DIV",{class:!0});var z=C(y);E=h(z,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(E)!=="svelte-1hipg1o"&&(E.textContent=D),g=I(z),p=h(z,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),J(p)!=="svelte-978zq4"&&(p.textContent=_),z.forEach(d),$.forEach(d),this.h()},h(){u(s,"class","reminder-emoji svelte-ldczv4"),u(c,"class","reminder-name svelte-ldczv4"),u(V,"class","reminder-status svelte-ldczv4"),Ue(V,"color",qs(l[20].daysSince)),u(i,"class","reminder-details svelte-ldczv4"),u(t,"class","reminder-info svelte-ldczv4"),u(E,"class","contact-btn svelte-ldczv4"),u(E,"title","Mark as contacted"),u(p,"class","delete-btn svelte-ldczv4"),u(p,"title","Remove"),u(y,"class","reminder-actions svelte-ldczv4"),u(e,"class","reminder-item svelte-ldczv4")},m(B,$){H(B,e,$),o(e,t),o(t,s),o(s,r),o(t,a),o(t,i),o(i,c),o(c,m),o(i,b),o(i,V),P.m(V,null),o(e,M),o(e,y),o(y,E),o(y,g),o(y,p),k||(w=[F(E,"click",L),F(p,"click",W)],k=!0)},p(B,$){l=B,$&1&&n!==(n=l[20].emoji+"")&&Z(r,n),$&1&&f!==(f=l[20].name+"")&&Z(m,f),T===(T=N(l))&&P?P.p(l,$):(P.d(1),P=T(l),P&&(P.c(),P.m(V,null))),$&1&&Ue(V,"color",qs(l[20].daysSince))},d(B){B&&d(e),P.d(),k=!1,tt(w)}}}function Ks(l){let e,t="<p>Add people you want to stay in touch with! üíô</p>";return{c(){e=v("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-12eicjj"&&(e.innerHTML=t),this.h()},h(){u(e,"class","empty-state svelte-ldczv4")},m(s,n){H(s,e,n)},d(s){s&&d(e)}}}function dn(l){let e,t,s,n="Stay Connected üíô",r,a,i="+ Add",c,f,m,b,V,M,y=l[1]&&zs(l),E=Je(l[0]),D=[];for(let p=0;p<E.length;p+=1)D[p]=Js(Bs(l,E,p));let g=l[0].length===0&&Ks();return{c(){e=v("div"),t=v("div"),s=v("h3"),s.textContent=n,r=S(),a=v("button"),a.textContent=i,c=S(),y&&y.c(),f=S(),m=v("div");for(let p=0;p<D.length;p+=1)D[p].c();b=S(),g&&g.c(),this.h()},l(p){e=h(p,"DIV",{class:!0});var _=C(e);t=h(_,"DIV",{class:!0});var k=C(t);s=h(k,"H3",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-3yj0ye"&&(s.textContent=n),r=I(k),a=h(k,"BUTTON",{class:!0,"data-svelte-h":!0}),J(a)!=="svelte-1v82sm9"&&(a.textContent=i),k.forEach(d),c=I(_),y&&y.l(_),f=I(_),m=h(_,"DIV",{class:!0});var w=C(m);for(let N=0;N<D.length;N+=1)D[N].l(w);b=I(w),g&&g.l(w),w.forEach(d),_.forEach(d),this.h()},h(){u(s,"class","svelte-ldczv4"),u(a,"class","add-btn svelte-ldczv4"),u(t,"class","reminders-header svelte-ldczv4"),u(m,"class","reminders-list svelte-ldczv4"),u(e,"class","connection-reminders-card svelte-ldczv4")},m(p,_){H(p,e,_),o(e,t),o(t,s),o(t,r),o(t,a),o(e,c),y&&y.m(e,null),o(e,f),o(e,m);for(let k=0;k<D.length;k+=1)D[k]&&D[k].m(m,null);o(m,b),g&&g.m(m,null),V||(M=F(a,"click",l[9]),V=!0)},p(p,[_]){if(p[1]?y?y.p(p,_):(y=zs(p),y.c(),y.m(e,f)):y&&(y.d(1),y=null),_&321){E=Je(p[0]);let k;for(k=0;k<E.length;k+=1){const w=Bs(p,E,k);D[k]?D[k].p(w,_):(D[k]=Js(w),D[k].c(),D[k].m(m,b))}for(;k<D.length;k+=1)D[k].d(1);D.length=E.length}p[0].length===0?g||(g=Ks(),g.c(),g.m(m,null)):g&&(g.d(1),g=null)},i:Ve,o:Ve,d(p){p&&d(e),y&&y.d(),ot(D,p),g&&g.d(),V=!1,M()}}}function Ws(l){if(!l)return 999;const e=new Date(l+"T00:00:00"),t=new Date;t.setHours(0,0,0,0);const s=t-e,n=Math.floor(s/(1e3*60*60*24));return Math.max(0,n)}function qs(l){return l<=3?"#22c55e":l<=7?"#eab308":l<=14?"#f97316":"#ef4444"}function hn(l,e,t){const s=new Et;let n=[],r=!1,a="",i="friend",c="";const f=[{value:"friend",label:"Friend",emoji:"üë´"},{value:"family",label:"Family",emoji:"üë®‚Äçüë©‚Äçüëß‚Äçüë¶"},{value:"partner",label:"Partner",emoji:"üíë"},{value:"mentor",label:"Mentor",emoji:"üßë‚Äçüè´"}];mt(()=>{m()});function m(){if(!(typeof window>"u"))try{const T=localStorage.getItem("connection_reminders");T?t(0,n=JSON.parse(T)):(t(0,n=[{id:1,name:"Mom",type:"family",emoji:"üë©",daysSince:0,lastContact:null},{id:2,name:"Best Friend",type:"friend",emoji:"üë´",daysSince:0,lastContact:null}]),b())}catch(T){console.error("Error loading reminders:",T),t(0,n=[])}}function b(){if(!(typeof window>"u"))try{localStorage.setItem("connection_reminders",JSON.stringify(n))}catch(T){console.error("Error saving reminders:",T)}}function V(T){const P=s.formatDate();T.lastContact=P,T.daysSince=0,b(),t(0,n=[...n])}function M(){if(!a.trim())return;const T=f.find(L=>L.value===i),P={id:Date.now(),name:a,type:i,emoji:(T==null?void 0:T.emoji)||"üë§",daysSince:c?Ws(c):999,lastContact:c||null};t(0,n=[...n,P]),b(),t(2,a=""),t(4,c=""),t(1,r=!1)}function y(T){t(0,n=n.filter(P=>P.id!==T)),b()}function E(){t(0,n=n.map(T=>({...T,daysSince:T.lastContact?Ws(T.lastContact):999})))}const D=()=>t(1,r=!r);function g(){a=this.value,t(2,a)}function p(){i=gl(this),t(3,i),t(5,f)}function _(){c=this.value,t(4,c)}const k=()=>t(1,r=!1),w=T=>V(T),N=T=>y(T.id);return l.$$.update=()=>{l.$$.dirty&1&&n.length>0&&E()},[n,r,a,i,c,f,V,M,y,D,g,p,_,k,w,N]}class vn extends ft{constructor(e){super(),dt(this,e,hn,dn,ut,{})}}function Ys(l,e,t){const s=l.slice();return s[11]=e[t],s}function Gs(l,e,t){const s=l.slice();return s[14]=e[t],s}function Xs(l,e,t){const s=l.slice();return s[11]=e[t],s}function mn(l){let e,t=Je(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=tl(Gs(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=h(n,"DIV",{class:!0});var r=C(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(d),this.h()},h(){u(e,"class","entries-grid svelte-1m68utd")},m(n,r){H(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r&41){t=Je(n[0]);let a;for(a=0;a<t.length;a+=1){const i=Gs(n,t,a);s[a]?s[a].p(i,r):(s[a]=tl(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&d(e),ot(s,n)}}}function pn(l){let e,t='<div class="empty-icon svelte-1m68utd">‚≠ê</div> <h3 class="svelte-1m68utd">No starred entries yet</h3> <p class="svelte-1m68utd">Star entries you want to remember by clicking the star icon on any diary entry.</p>';return{c(){e=v("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-5hp5nd"&&(e.innerHTML=t),this.h()},h(){u(e,"class","empty-state svelte-1m68utd")},m(s,n){H(s,e,n)},p:Ve,d(s){s&&d(e)}}}function Qs(l){let e,t,s=Rt(l[14].metadata.mood)+"",n,r,a=l[14].metadata.wordCount>0&&Zs(l);return{c(){e=v("div"),t=v("span"),n=U(s),r=S(),a&&a.c(),this.h()},l(i){e=h(i,"DIV",{class:!0});var c=C(e);t=h(c,"SPAN",{class:!0});var f=C(t);n=A(f,s),f.forEach(d),r=I(c),a&&a.l(c),c.forEach(d),this.h()},h(){u(t,"class","mood-indicator svelte-1m68utd"),u(e,"class","entry-meta svelte-1m68utd")},m(i,c){H(i,e,c),o(e,t),o(t,n),o(e,r),a&&a.m(e,null)},p(i,c){c&1&&s!==(s=Rt(i[14].metadata.mood)+"")&&Z(n,s),i[14].metadata.wordCount>0?a?a.p(i,c):(a=Zs(i),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(i){i&&d(e),a&&a.d()}}}function Zs(l){let e,t=l[14].metadata.wordCount+"",s,n;return{c(){e=v("span"),s=U(t),n=U(" words"),this.h()},l(r){e=h(r,"SPAN",{class:!0});var a=C(e);s=A(a,t),n=A(a," words"),a.forEach(d),this.h()},h(){u(e,"class","word-count svelte-1m68utd")},m(r,a){H(r,e,a),o(e,s),o(e,n)},p(r,a){a&1&&t!==(t=r[14].metadata.wordCount+"")&&Z(s,t)},d(r){r&&d(e)}}}function xs(l){let e,t,s=Je(l[14].metadata.tags.slice(0,3)),n=[];for(let a=0;a<s.length;a+=1)n[a]=$s(Xs(l,s,a));let r=l[14].metadata.tags.length>3&&el(l);return{c(){e=v("div");for(let a=0;a<n.length;a+=1)n[a].c();t=S(),r&&r.c(),this.h()},l(a){e=h(a,"DIV",{class:!0});var i=C(e);for(let c=0;c<n.length;c+=1)n[c].l(i);t=I(i),r&&r.l(i),i.forEach(d),this.h()},h(){u(e,"class","entry-tags svelte-1m68utd")},m(a,i){H(a,e,i);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);o(e,t),r&&r.m(e,null)},p(a,i){if(i&1){s=Je(a[14].metadata.tags.slice(0,3));let c;for(c=0;c<s.length;c+=1){const f=Xs(a,s,c);n[c]?n[c].p(f,i):(n[c]=$s(f),n[c].c(),n[c].m(e,t))}for(;c<n.length;c+=1)n[c].d(1);n.length=s.length}a[14].metadata.tags.length>3?r?r.p(a,i):(r=el(a),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(a){a&&d(e),ot(n,a),r&&r.d()}}}function $s(l){let e,t=l[11]+"",s;return{c(){e=v("span"),s=U(t),this.h()},l(n){e=h(n,"SPAN",{class:!0});var r=C(e);s=A(r,t),r.forEach(d),this.h()},h(){u(e,"class","tag-small svelte-1m68utd")},m(n,r){H(n,e,r),o(e,s)},p(n,r){r&1&&t!==(t=n[11]+"")&&Z(s,t)},d(n){n&&d(e)}}}function el(l){let e,t,s=l[14].metadata.tags.length-3+"",n;return{c(){e=v("span"),t=U("+"),n=U(s),this.h()},l(r){e=h(r,"SPAN",{class:!0});var a=C(e);t=A(a,"+"),n=A(a,s),a.forEach(d),this.h()},h(){u(e,"class","tag-small svelte-1m68utd")},m(r,a){H(r,e,a),o(e,t),o(e,n)},p(r,a){a&1&&s!==(s=r[14].metadata.tags.length-3+"")&&Z(n,s)},d(r){r&&d(e)}}}function tl(l){let e,t,s,n=l[14].display+"",r,a,i,c="‚≠ê",f,m,b,V,M=l[14].content.substring(0,150)+"",y,E=l[14].content.length>150?"...":"",D,g,p,_;function k(){return l[7](l[14])}let w=l[14].metadata.mood&&Qs(l),N=l[14].metadata.tags&&l[14].metadata.tags.length>0&&xs(l);function T(){return l[8](l[14])}return{c(){e=v("div"),t=v("div"),s=v("div"),r=U(n),a=S(),i=v("button"),i.textContent=c,f=S(),w&&w.c(),m=S(),N&&N.c(),b=S(),V=v("div"),y=U(M),D=U(E),g=S(),this.h()},l(P){e=h(P,"DIV",{class:!0,role:!0,tabindex:!0});var L=C(e);t=h(L,"DIV",{class:!0});var W=C(t);s=h(W,"DIV",{class:!0});var B=C(s);r=A(B,n),B.forEach(d),a=I(W),i=h(W,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-katq82"&&(i.textContent=c),W.forEach(d),f=I(L),w&&w.l(L),m=I(L),N&&N.l(L),b=I(L),V=h(L,"DIV",{class:!0});var $=C(V);y=A($,M),D=A($,E),$.forEach(d),g=I(L),L.forEach(d),this.h()},h(){u(s,"class","entry-date svelte-1m68utd"),u(i,"class","star-btn active svelte-1m68utd"),u(i,"title","Unstar entry"),u(i,"type","button"),u(t,"class","entry-card-header svelte-1m68utd"),u(V,"class","entry-preview svelte-1m68utd"),u(e,"class","entry-card svelte-1m68utd"),u(e,"role","button"),u(e,"tabindex","0")},m(P,L){H(P,e,L),o(e,t),o(t,s),o(s,r),o(t,a),o(t,i),o(e,f),w&&w.m(e,null),o(e,m),N&&N.m(e,null),o(e,b),o(e,V),o(V,y),o(V,D),o(e,g),p||(_=[F(i,"click",jt(k)),F(e,"click",T)],p=!0)},p(P,L){l=P,L&1&&n!==(n=l[14].display+"")&&Z(r,n),l[14].metadata.mood?w?w.p(l,L):(w=Qs(l),w.c(),w.m(e,m)):w&&(w.d(1),w=null),l[14].metadata.tags&&l[14].metadata.tags.length>0?N?N.p(l,L):(N=xs(l),N.c(),N.m(e,b)):N&&(N.d(1),N=null),L&1&&M!==(M=l[14].content.substring(0,150)+"")&&Z(y,M),L&1&&E!==(E=l[14].content.length>150?"...":"")&&Z(D,E)},d(P){P&&d(e),w&&w.d(),N&&N.d(),p=!1,tt(_)}}}function sl(l){let e,t,s,n,r,a=l[1].display+"",i,c,f,m,b="√ó",V,M,y,E,D,g,p=(l[1].metadata.mood||l[1].metadata.wordCount>0)&&ll(l),_=l[1].metadata.tags&&l[1].metadata.tags.length>0&&al(l);return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("div"),r=v("h3"),i=U(a),c=S(),p&&p.c(),f=S(),m=v("button"),m.textContent=b,V=S(),_&&_.c(),M=S(),y=v("div"),E=U(l[2]),this.h()},l(k){e=h(k,"DIV",{class:!0});var w=C(e);t=h(w,"DIV",{class:!0});var N=C(t);s=h(N,"DIV",{class:!0});var T=C(s);n=h(T,"DIV",{});var P=C(n);r=h(P,"H3",{class:!0});var L=C(r);i=A(L,a),L.forEach(d),c=I(P),p&&p.l(P),P.forEach(d),f=I(T),m=h(T,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(m)!=="svelte-pj7yet"&&(m.textContent=b),T.forEach(d),V=I(N),_&&_.l(N),M=I(N),y=h(N,"DIV",{class:!0});var W=C(y);E=A(W,l[2]),W.forEach(d),N.forEach(d),w.forEach(d),this.h()},h(){u(r,"class","svelte-1m68utd"),u(m,"class","close-modal svelte-1m68utd"),u(m,"type","button"),u(s,"class","entry-modal-header svelte-1m68utd"),u(y,"class","entry-content svelte-1m68utd"),u(t,"class","entry-modal-content svelte-1m68utd"),u(e,"class","entry-modal svelte-1m68utd")},m(k,w){H(k,e,w),o(e,t),o(t,s),o(s,n),o(n,r),o(r,i),o(n,c),p&&p.m(n,null),o(s,f),o(s,m),o(t,V),_&&_.m(t,null),o(t,M),o(t,y),o(y,E),D||(g=F(m,"click",l[4]),D=!0)},p(k,w){w&2&&a!==(a=k[1].display+"")&&Z(i,a),k[1].metadata.mood||k[1].metadata.wordCount>0?p?p.p(k,w):(p=ll(k),p.c(),p.m(n,null)):p&&(p.d(1),p=null),k[1].metadata.tags&&k[1].metadata.tags.length>0?_?_.p(k,w):(_=al(k),_.c(),_.m(t,M)):_&&(_.d(1),_=null),w&4&&Z(E,k[2])},d(k){k&&d(e),p&&p.d(),_&&_.d(),D=!1,g()}}}function ll(l){let e,t,s=l[1].metadata.mood&&nl(l),n=l[1].metadata.wordCount>0&&rl(l);return{c(){e=v("div"),s&&s.c(),t=S(),n&&n.c(),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=C(e);s&&s.l(a),t=I(a),n&&n.l(a),a.forEach(d),this.h()},h(){u(e,"class","entry-meta svelte-1m68utd")},m(r,a){H(r,e,a),s&&s.m(e,null),o(e,t),n&&n.m(e,null)},p(r,a){r[1].metadata.mood?s?s.p(r,a):(s=nl(r),s.c(),s.m(e,t)):s&&(s.d(1),s=null),r[1].metadata.wordCount>0?n?n.p(r,a):(n=rl(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(r){r&&d(e),s&&s.d(),n&&n.d()}}}function nl(l){let e,t=Rt(l[1].metadata.mood)+"",s;return{c(){e=v("span"),s=U(t),this.h()},l(n){e=h(n,"SPAN",{class:!0});var r=C(e);s=A(r,t),r.forEach(d),this.h()},h(){u(e,"class","mood-indicator svelte-1m68utd")},m(n,r){H(n,e,r),o(e,s)},p(n,r){r&2&&t!==(t=Rt(n[1].metadata.mood)+"")&&Z(s,t)},d(n){n&&d(e)}}}function rl(l){let e,t=l[1].metadata.wordCount+"",s,n;return{c(){e=v("span"),s=U(t),n=U(" words"),this.h()},l(r){e=h(r,"SPAN",{class:!0});var a=C(e);s=A(a,t),n=A(a," words"),a.forEach(d),this.h()},h(){u(e,"class","word-count svelte-1m68utd")},m(r,a){H(r,e,a),o(e,s),o(e,n)},p(r,a){a&2&&t!==(t=r[1].metadata.wordCount+"")&&Z(s,t)},d(r){r&&d(e)}}}function al(l){let e,t=Je(l[1].metadata.tags),s=[];for(let n=0;n<t.length;n+=1)s[n]=ol(Ys(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=h(n,"DIV",{class:!0});var r=C(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(d),this.h()},h(){u(e,"class","entry-tags-full svelte-1m68utd")},m(n,r){H(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r&2){t=Je(n[1].metadata.tags);let a;for(a=0;a<t.length;a+=1){const i=Ys(n,t,a);s[a]?s[a].p(i,r):(s[a]=ol(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&d(e),ot(s,n)}}}function ol(l){let e,t=l[11]+"",s;return{c(){e=v("span"),s=U(t),this.h()},l(n){e=h(n,"SPAN",{class:!0});var r=C(e);s=A(r,t),r.forEach(d),this.h()},h(){u(e,"class","tag svelte-1m68utd")},m(n,r){H(n,e,r),o(e,s)},p(n,r){r&2&&t!==(t=n[11]+"")&&Z(s,t)},d(n){n&&d(e)}}}function gn(l){let e,t,s,n="‚≠ê Starred Entries",r,a,i=l[0].length+"",c,f,m=l[0].length===1?"entry":"entries",b,V,M,y;function E(_,k){return _[0].length===0?pn:mn}let D=E(l),g=D(l),p=l[1]&&sl(l);return{c(){e=v("div"),t=v("div"),s=v("h2"),s.textContent=n,r=S(),a=v("p"),c=U(i),f=S(),b=U(m),V=U(" saved"),M=S(),g.c(),y=S(),p&&p.c(),this.h()},l(_){e=h(_,"DIV",{class:!0});var k=C(e);t=h(k,"DIV",{class:!0});var w=C(t);s=h(w,"H2",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-3lvs5z"&&(s.textContent=n),r=I(w),a=h(w,"P",{class:!0});var N=C(a);c=A(N,i),f=I(N),b=A(N,m),V=A(N," saved"),N.forEach(d),w.forEach(d),M=I(k),g.l(k),y=I(k),p&&p.l(k),k.forEach(d),this.h()},h(){u(s,"class","svelte-1m68utd"),u(a,"class","favorites-subtitle svelte-1m68utd"),u(t,"class","favorites-header svelte-1m68utd"),u(e,"class","favorites-view svelte-1m68utd")},m(_,k){H(_,e,k),o(e,t),o(t,s),o(t,r),o(t,a),o(a,c),o(a,f),o(a,b),o(a,V),o(e,M),g.m(e,null),o(e,y),p&&p.m(e,null)},p(_,[k]){k&1&&i!==(i=_[0].length+"")&&Z(c,i),k&1&&m!==(m=_[0].length===1?"entry":"entries")&&Z(b,m),D===(D=E(_))&&g?g.p(_,k):(g.d(1),g=D(_),g&&(g.c(),g.m(e,y))),_[1]?p?p.p(_,k):(p=sl(_),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i:Ve,o:Ve,d(_){_&&d(e),g.d(),p&&p.d()}}}function _n(l){const e=new Date(l+"T00:00:00"),t=new Date;t.setHours(0,0,0,0);const s=new Date(e);s.setHours(0,0,0,0);const n=t-s,r=Math.floor(n/(1e3*60*60*24));if(r===0)return"Today";if(r===1)return"Yesterday";if(r<7)return`${r} days ago`;const a={weekday:"long",year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("en-US",a)}function Rt(l){return{happy:"üòä",calm:"üòå",sad:"üò¢",anxious:"üò∞",lonely:"üòî",tired:"üò¥",frustrated:"üò§",loved:"ü•∞"}[l]||""}function yn(l,e,t){const s=new Et;let n=[],r=null,a="";function i(){const y=s.getStarredEntries();t(0,n=y.map(E=>{const D=s.getEntry(E),g=s.getMetadata(E);return{date:E,content:D,metadata:g,display:_n(E)}}).sort((E,D)=>new Date(D.date+"T00:00:00")-new Date(E.date+"T00:00:00")))}function c(y){t(1,r=y),t(2,a=y.content)}function f(){t(1,r=null),t(2,a="")}function m(y){s.toggleStar(y),i(),r&&r.date===y&&t(1,r.metadata.starred=!r.metadata.starred,r)}function b(){i()}return mt(()=>{i()}),[n,r,a,c,f,m,b,y=>m(y.date),y=>c(y)]}class bn extends ft{constructor(e){super(),dt(this,e,yn,gn,ut,{refresh:6})}get refresh(){return this.$$.ctx[6]}}function il(l){let e,t,s,n,r="üîí Your Privacy Matters",a,i,c="√ó",f,m,b,V='<strong class="svelte-wh4280">‚úì Your data stays local</strong> <p class="svelte-wh4280">All your diary entries and chat conversations are stored locally in your browser. Nothing is sent to external servers except for AI processing (which doesn&#39;t store your data).</p>',M,y,E='<strong class="svelte-wh4280">‚úì Private entries</strong> <p class="svelte-wh4280">You can mark any diary entry as private (üîí). Private entries are never shared with the chatbot unless you explicitly allow it.</p>',D,g,p='<strong class="svelte-wh4280">‚úì You&#39;re in control</strong> <p class="svelte-wh4280">You can delete any entry or chat at any time. Your data belongs to you.</p>',_,k,w,N,T,P,L="Don't show this again",W,B;return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("h3"),n.textContent=r,a=S(),i=v("button"),i.textContent=c,f=S(),m=v("div"),b=v("div"),b.innerHTML=V,M=S(),y=v("div"),y.innerHTML=E,D=S(),g=v("div"),g.innerHTML=p,_=S(),k=v("div"),w=v("label"),N=v("input"),T=S(),P=v("span"),P.textContent=L,this.h()},l($){e=h($,"DIV",{class:!0});var le=C(e);t=h(le,"DIV",{class:!0});var Q=C(t);s=h(Q,"DIV",{class:!0});var ne=C(s);n=h(ne,"H3",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-1l92ou"&&(n.textContent=r),a=I(ne),i=h(ne,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),J(i)!=="svelte-1oxddek"&&(i.textContent=c),ne.forEach(d),f=I(Q),m=h(Q,"DIV",{class:!0});var K=C(m);b=h(K,"DIV",{class:!0,"data-svelte-h":!0}),J(b)!=="svelte-713pj2"&&(b.innerHTML=V),M=I(K),y=h(K,"DIV",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-15t18h4"&&(y.innerHTML=E),D=I(K),g=h(K,"DIV",{class:!0,"data-svelte-h":!0}),J(g)!=="svelte-5mzgqy"&&(g.innerHTML=p),_=I(K),k=h(K,"DIV",{class:!0});var x=C(k);w=h(x,"LABEL",{class:!0});var z=C(w);N=h(z,"INPUT",{type:!0,class:!0}),T=I(z),P=h(z,"SPAN",{"data-svelte-h":!0}),J(P)!=="svelte-14sn2z5"&&(P.textContent=L),z.forEach(d),x.forEach(d),K.forEach(d),Q.forEach(d),le.forEach(d),this.h()},h(){u(n,"class","svelte-wh4280"),u(i,"class","close-privacy svelte-wh4280"),u(i,"type","button"),u(s,"class","privacy-header svelte-wh4280"),u(b,"class","privacy-point svelte-wh4280"),u(y,"class","privacy-point svelte-wh4280"),u(g,"class","privacy-point svelte-wh4280"),u(N,"type","checkbox"),u(N,"class","svelte-wh4280"),u(w,"class","dont-show-again svelte-wh4280"),u(k,"class","privacy-footer svelte-wh4280"),u(m,"class","privacy-body svelte-wh4280"),u(t,"class","privacy-info-content svelte-wh4280"),u(e,"class","privacy-info-modal svelte-wh4280")},m($,le){H($,e,le),o(e,t),o(t,s),o(s,n),o(s,a),o(s,i),o(t,f),o(t,m),o(m,b),o(m,M),o(m,y),o(m,D),o(m,g),o(m,_),o(m,k),o(k,w),o(w,N),o(w,T),o(w,P),W||(B=[F(i,"click",l[1]),F(N,"change",l[3])],W=!0)},p:Ve,d($){$&&d(e),W=!1,tt(B)}}}function kn(l){let e,t="üîí Privacy",s,n,r,a,i=l[0]&&il(l);return{c(){e=v("button"),e.textContent=t,s=S(),i&&i.c(),n=at(),this.h()},l(c){e=h(c,"BUTTON",{class:!0,title:!0,type:!0,"data-svelte-h":!0}),J(e)!=="svelte-nqevf4"&&(e.textContent=t),s=I(c),i&&i.l(c),n=at(),this.h()},h(){u(e,"class","privacy-info-btn svelte-wh4280"),u(e,"title","Privacy information"),u(e,"type","button")},m(c,f){H(c,e,f),H(c,s,f),i&&i.m(c,f),H(c,n,f),r||(a=F(e,"click",l[2]),r=!0)},p(c,[f]){c[0]?i?i.p(c,f):(i=il(c),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},i:Ve,o:Ve,d(c){c&&(d(e),d(s),d(n)),i&&i.d(c),r=!1,a()}}}function Cn(l,e,t){let s=!1,n=!1;mt(()=>{typeof window<"u"&&(n=localStorage.getItem("has_seen_privacy_info")==="true",n||setTimeout(()=>{t(0,s=!0)},2e3))});function r(){t(0,s=!1),typeof window<"u"&&localStorage.setItem("has_seen_privacy_info","true")}function a(){t(0,s=!s)}return[s,r,a,c=>{c.target.checked&&r()}]}class wn extends ft{constructor(e){super(),dt(this,e,Cn,kn,ut,{})}}function cl(l){let e,t,s,n={};return t=new Ml({props:n}),l[17](t),t.$on("startInteractive",l[9]),t.$on("entrySaved",l[8]),t.$on("moodSaved",l[12]),t.$on("talkAboutDay",l[13]),{c(){e=v("div"),rt(t.$$.fragment),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=C(e);nt(t.$$.fragment,a),a.forEach(d),this.h()},h(){u(e,"class","diary-view svelte-1nnv5h4")},m(r,a){H(r,e,a),lt(t,e,null),s=!0},p(r,a){const i={};t.$set(i)},i(r){s||(Fe(t.$$.fragment,r),s=!0)},o(r){Xe(t.$$.fragment,r),s=!1},d(r){r&&d(e),l[17](null),st(t)}}}function ul(l){let e,t,s,n,r,a={};return t=new on({props:a}),l[19](t),n=new vn({}),{c(){e=v("div"),rt(t.$$.fragment),s=S(),rt(n.$$.fragment),this.h()},l(i){e=h(i,"DIV",{class:!0});var c=C(e);nt(t.$$.fragment,c),s=I(c),nt(n.$$.fragment,c),c.forEach(d),this.h()},h(){u(e,"class","insights-view svelte-1nnv5h4")},m(i,c){H(i,e,c),lt(t,e,null),o(e,s),lt(n,e,null),r=!0},p(i,c){const f={};t.$set(f)},i(i){r||(Fe(t.$$.fragment,i),Fe(n.$$.fragment,i),r=!0)},o(i){Xe(t.$$.fragment,i),Xe(n.$$.fragment,i),r=!1},d(i){i&&d(e),l[19](null),st(t),st(n)}}}function fl(l){let e,t,s,n={};return t=new bn({props:n}),l[20](t),{c(){e=v("div"),rt(t.$$.fragment),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=C(e);nt(t.$$.fragment,a),a.forEach(d),this.h()},h(){u(e,"class","favorites-view svelte-1nnv5h4")},m(r,a){H(r,e,a),lt(t,e,null),s=!0},p(r,a){const i={};t.$set(i)},i(r){s||(Fe(t.$$.fragment,r),s=!0)},o(r){Xe(t.$$.fragment,r),s=!1},d(r){r&&d(e),l[20](null),st(t)}}}function Dn(l){let e,t,s,n,r,a,i,c,f="üìñ Diary",m,b,V="üí¨ Interactive Mode",M,y,E="üìä Insights",D,g,p="‚≠ê Favorites",_,k,w,N,T,P,L,W,B,$,le={};s=new sn({props:le}),l[16](s),r=new wn({});let Q=l[0]==="diary"&&cl(l),ne={diaryContext:l[1],includeTodayEntry:En,todayEntry:l[2]};T=new $l({props:ne}),l[18](T);let K=l[0]==="insights"&&ul(l),x=l[0]==="favorites"&&fl(l);return{c(){e=S(),t=v("div"),rt(s.$$.fragment),n=S(),rt(r.$$.fragment),a=S(),i=v("div"),c=v("button"),c.textContent=f,m=S(),b=v("button"),b.textContent=V,M=S(),y=v("button"),y.textContent=E,D=S(),g=v("button"),g.textContent=p,_=S(),k=v("div"),Q&&Q.c(),w=S(),N=v("div"),rt(T.$$.fragment),P=S(),K&&K.c(),L=S(),x&&x.c(),this.h()},l(z){_l("svelte-1jk6co1",document.head).forEach(d),e=I(z),t=h(z,"DIV",{class:!0});var ue=C(t);nt(s.$$.fragment,ue),n=I(ue),nt(r.$$.fragment,ue),a=I(ue),i=h(ue,"DIV",{class:!0});var oe=C(i);c=h(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(c)!=="svelte-c6kclm"&&(c.textContent=f),m=I(oe),b=h(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(b)!=="svelte-7ltcyi"&&(b.textContent=V),M=I(oe),y=h(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(y)!=="svelte-11bwtg4"&&(y.textContent=E),D=I(oe),g=h(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(g)!=="svelte-14i5as9"&&(g.textContent=p),oe.forEach(d),_=I(ue),k=h(ue,"DIV",{class:!0});var be=C(k);Q&&Q.l(be),w=I(be),N=h(be,"DIV",{class:!0});var _e=C(N);nt(T.$$.fragment,_e),_e.forEach(d),P=I(be),K&&K.l(be),L=I(be),x&&x.l(be),be.forEach(d),ue.forEach(d),this.h()},h(){document.title="Diary Chatbot",u(c,"class","tab-btn svelte-1nnv5h4"),Y(c,"active",l[0]==="diary"),u(b,"class","tab-btn svelte-1nnv5h4"),Y(b,"active",l[0]==="chat"),u(y,"class","tab-btn svelte-1nnv5h4"),Y(y,"active",l[0]==="insights"),u(g,"class","tab-btn svelte-1nnv5h4"),Y(g,"active",l[0]==="favorites"),u(i,"class","nav-tabs svelte-1nnv5h4"),u(N,"class","chat-view svelte-1nnv5h4"),Y(N,"hidden",l[0]!=="chat"),u(k,"class","content-area svelte-1nnv5h4"),u(t,"class","app-container svelte-1nnv5h4")},m(z,ce){H(z,e,ce),H(z,t,ce),lt(s,t,null),o(t,n),lt(r,t,null),o(t,a),o(t,i),o(i,c),o(i,m),o(i,b),o(i,M),o(i,y),o(i,D),o(i,g),o(t,_),o(t,k),Q&&Q.m(k,null),o(k,w),o(k,N),lt(T,N,null),o(k,P),K&&K.m(k,null),o(k,L),x&&x.m(k,null),W=!0,B||($=[F(c,"click",l[10]),F(b,"click",l[14]),F(y,"click",l[15]),F(g,"click",l[11])],B=!0)},p(z,[ce]){const ue={};s.$set(ue),(!W||ce&1)&&Y(c,"active",z[0]==="diary"),(!W||ce&1)&&Y(b,"active",z[0]==="chat"),(!W||ce&1)&&Y(y,"active",z[0]==="insights"),(!W||ce&1)&&Y(g,"active",z[0]==="favorites"),z[0]==="diary"?Q?(Q.p(z,ce),ce&1&&Fe(Q,1)):(Q=cl(z),Q.c(),Fe(Q,1),Q.m(k,w)):Q&&(Ut(),Xe(Q,1,1,()=>{Q=null}),Ht());const oe={};ce&2&&(oe.diaryContext=z[1]),ce&4&&(oe.todayEntry=z[2]),T.$set(oe),(!W||ce&1)&&Y(N,"hidden",z[0]!=="chat"),z[0]==="insights"?K?(K.p(z,ce),ce&1&&Fe(K,1)):(K=ul(z),K.c(),Fe(K,1),K.m(k,L)):K&&(Ut(),Xe(K,1,1,()=>{K=null}),Ht()),z[0]==="favorites"?x?(x.p(z,ce),ce&1&&Fe(x,1)):(x=fl(z),x.c(),Fe(x,1),x.m(k,null)):x&&(Ut(),Xe(x,1,1,()=>{x=null}),Ht())},i(z){W||(Fe(s.$$.fragment,z),Fe(r.$$.fragment,z),Fe(Q),Fe(T.$$.fragment,z),Fe(K),Fe(x),W=!0)},o(z){Xe(s.$$.fragment,z),Xe(r.$$.fragment,z),Xe(Q),Xe(T.$$.fragment,z),Xe(K),Xe(x),W=!1},d(z){z&&(d(e),d(t)),l[16](null),st(s),st(r),Q&&Q.d(),l[18](null),st(T),K&&K.d(),x&&x.d(),B=!1,tt($)}}}let En=!1;function In(l,e,t){let s="diary",n="",r="",a,i,c,f,m;const b=new Et;mt(()=>{V(),M()});function V(){t(1,n=b.getContextForAgents())}function M(){const B=b.formatDate();t(2,r=b.getEntry(B))}function y(){M(),V()}function E(){V(),M(),t(0,s="chat")}function D(){t(0,s="diary")}function g(){t(0,s="favorites"),m&&m.refresh&&m.refresh()}function p(B){const{date:$,mood:le}=B.detail;a&&a.updateMoodForDate&&a.updateMoodForDate($,le)}function _(B){const{date:$}=B.detail;V(),M(),t(0,s="chat"),i&&i.importEntryForDate&&i.importEntryForDate($)}function k(){V(),M(),t(0,s="chat")}function w(){t(0,s="insights"),f&&f.refresh()}function N(B){vt[B?"unshift":"push"](()=>{c=B,t(5,c)})}function T(B){vt[B?"unshift":"push"](()=>{a=B,t(3,a)})}function P(B){vt[B?"unshift":"push"](()=>{i=B,t(4,i)})}function L(B){vt[B?"unshift":"push"](()=>{f=B,t(6,f)})}function W(B){vt[B?"unshift":"push"](()=>{m=B,t(7,m)})}return[s,n,r,a,i,c,f,m,y,E,D,g,p,_,k,w,N,T,P,L,W]}class Vn extends ft{constructor(e){super(),dt(this,e,In,Dn,ut,{})}}export{Vn as component};
